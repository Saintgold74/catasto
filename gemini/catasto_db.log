2025-04-30 09:50:00,322 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 09:50:00,460 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 09:51:23,130 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione ricerca_avanzata_possessori(unknown) non esiste
LINE 1: SELECT * FROM ricerca_avanzata_possessori('fossati')
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 09:51:23,131 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 09:51:23,132 - CatastoDB - ERROR - Query renderizzata: b"SELECT * FROM ricerca_avanzata_possessori('fossati')"
2025-04-30 09:51:23,133 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 09:51:23,134 - CatastoDB - WARNING - Funzione 'ricerca_avanzata_possessori' non trovata.
2025-04-30 09:55:45,633 - CatastoDB - INFO - Disconnessione completata
2025-04-30 10:40:05,968 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 10:40:06,086 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 10:44:16,871 - CatastoDB - INFO - Disconnessione completata
2025-04-30 10:49:25,714 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 10:49:25,786 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 10:50:06,801 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-04-30 10:50:06,828 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione ricerca_avanzata_immobili(integer, unknown, unknown, unknown, unknown) non esiste
LINE 1: SELECT * FROM ricerca_avanzata_immobili(3, 'casa', NULL, NUL...
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 10:50:06,828 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 10:50:06,829 - CatastoDB - ERROR - Query renderizzata: b"SELECT * FROM ricerca_avanzata_immobili(3, 'casa', NULL, NULL, NULL)"
2025-04-30 10:50:06,830 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 10:50:06,830 - CatastoDB - WARNING - Funzione 'ricerca_avanzata_immobili' non trovata.
2025-04-30 11:14:46,289 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:14:46,492 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:14:58,774 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-04-30 11:23:24,592 - CatastoDB - INFO - Localit‡ 'Regione Bagnoli' (Comune ID: 4) inserita con ID: 7
2025-04-30 11:24:14,683 - CatastoDB - INFO - Localit‡ 'Regione Poca' (Comune ID: 4) inserita con ID: 8
2025-04-30 11:24:30,590 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:24:30,592 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 11:24:30,592 - CatastoDB - ERROR - Query renderizzata: b'CALL registra_nuova_proprieta(4, 99, \'2025-04-01\'::date, \'[{"nome_completo": "Santoro Marco di Pasquale", "cognome_nome": "Santoro Marco", "paternita": "di Pasquale"}]\'::json, \'[{"natura": "Casa", "localita_id": 7, "classificazione": null, "numero_piani": 2, "numero_vani": 2, "consistenza": "120"}, {"natura": "Casa", "localita_id": 8, "classificazione": null, "numero_piani": null, "numero_vani": null, "consistenza": null}]\'::json)'
2025-04-30 11:24:30,593 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:24:30,593 - CatastoDB - ERROR - Errore DB registrazione nuova propriet‡ (Partita 99): ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:33:22,797 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:33:25,824 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:33:25,898 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:34:25,191 - CatastoDB - INFO - Localit‡ 'Regione Bagnoli' (Comune ID: 4) inserita con ID: 9
2025-04-30 11:34:35,875 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:34:35,876 - CatastoDB - ERROR - SQLSTATE: 42883
2025-04-30 11:34:35,876 - CatastoDB - ERROR - Query renderizzata: b'CALL registra_nuova_proprieta(4, 99, \'2025-04-01\'::date, \'[{"nome_completo": "Santoro Marco di Pasquale", "cognome_nome": "Santoro Marco", "paternita": "di Pasquale"}]\'::json, \'[{"natura": "casa", "localita_id": 9, "classificazione": null, "numero_piani": null, "numero_vani": null, "consistenza": null}]\'::json)'
2025-04-30 11:34:35,877 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:34:35,878 - CatastoDB - ERROR - Errore DB registrazione nuova propriet‡ (Partita 99): ERRORE:  la procedura registra_nuova_proprieta(integer, integer, date, json, json) non esiste
LINE 1: CALL registra_nuova_proprieta(4, 99, '2025-04-01'::date, '[{...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-04-30 11:35:04,462 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:35:38,140 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:35:38,209 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:37:02,260 - CatastoDB - INFO - Localit‡ 'Regione Bagnoli' (Comune ID: 3) inserita con ID: 7
2025-04-30 11:37:10,781 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 3, Partita N.99
2025-04-30 11:38:46,937 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:38:46,937 - CatastoDB - ERROR - SQLSTATE: P0001
2025-04-30 11:38:46,938 - CatastoDB - ERROR - Query renderizzata: b"CALL inserisci_contratto(1, 'Vendita', '2025-01-01'::date, NULL, NULL, NULL)"
2025-04-30 11:38:46,938 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:38:46,939 - __main__ - ERROR - Errore non gestito nel menu principale: type object 'RaiseException' has no attribute 'sqlstate'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 517, in insert_contratto
    if self.execute_query(call_proc, params): self.commit(); logger.info(f"Contratto inserito per variazione ID {variazione_id}."); return True
       ~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 162, in execute_query
    raise db_err # RILANCIA l'eccezione per gestione specifica nel chiamante
    ^^^^^^^^^^^^
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 140, in execute_query
    self.cur.execute(query, params)
    ~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\saint\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\extras.py", line 146, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.RaiseException: ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 300, in menu_principale
    elif scelta == "2": menu_inserimento(db)
                        ~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 576, in menu_inserimento
    elif scelta == "7": _inserisci_contratto_interattivo(db)   # Invariato
                        ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 779, in _inserisci_contratto_interattivo
    if db.insert_contratto(var_id, tipo_contr, data_contr, notaio, repertorio, note): print(f"Contratto inserito per Variazione ID {var_id}.")
       ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 520, in insert_contratto
    if hasattr(db_err, 'pgcode') and db_err.pgcode == psycopg2.errors.RaiseException.sqlstate and 'Esiste gi‡ un contratto' in str(db_err): logger.warning(f"Contratto per variazione ID {variazione_id} esiste gi‡.")
                                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: type object 'RaiseException' has no attribute 'sqlstate'
2025-04-30 11:38:47,037 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:45:42,033 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:45:42,140 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:45:59,486 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:45:59,486 - CatastoDB - ERROR - SQLSTATE: P0001
2025-04-30 11:45:59,486 - CatastoDB - ERROR - Query renderizzata: b"CALL inserisci_contratto(1, 'Vendita', '2025-04-01'::date, NULL, NULL, NULL)"
2025-04-30 11:45:59,487 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:45:59,487 - CatastoDB - ERROR - Errore DB inserimento contratto var ID 1: ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:48:05,993 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:48:23,618 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:48:23,816 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:48:42,330 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:48:42,330 - CatastoDB - ERROR - SQLSTATE: P0001
2025-04-30 11:48:42,331 - CatastoDB - ERROR - Query renderizzata: b"CALL inserisci_contratto(1, 'Successione', '2025-01-01'::date, NULL, NULL, NULL)"
2025-04-30 11:48:42,331 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:48:42,332 - CatastoDB - ERROR - Errore DB inserimento contratto var ID 1: ERRORE:  Errore durante l'inserimento del contratto per variazione ID 1: Esiste gi√† un contratto per la variazione con ID 1
CONTEXT:  funzione PL/pgSQL inserisci_contratto(integer,character varying,date,character varying,character varying,text) riga 21 a RAISE

2025-04-30 11:49:49,821 - CatastoDB - INFO - Partita ID 1 duplicata in N.999.
2025-04-30 11:50:51,444 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedColumn - ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 24 a assegnazione

2025-04-30 11:50:51,444 - CatastoDB - ERROR - SQLSTATE: 42703
2025-04-30 11:50:51,444 - CatastoDB - ERROR - Query renderizzata: b'SELECT genera_certificato_proprieta(1) AS certificato'
2025-04-30 11:50:51,445 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:50:51,445 - CatastoDB - ERROR - Errore DB gen cert prop (ID: 1): ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 24 a assegnazione

2025-04-30 11:55:15,451 - CatastoDB - INFO - Disconnessione completata
2025-04-30 11:55:32,427 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-04-30 11:55:32,495 - CatastoDB - INFO - Connessione stabilita con successo
2025-04-30 11:55:36,184 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedColumn - ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 17 a assegnazione

2025-04-30 11:55:36,184 - CatastoDB - ERROR - SQLSTATE: 42703
2025-04-30 11:55:36,185 - CatastoDB - ERROR - Query renderizzata: b'SELECT genera_certificato_proprieta(1) AS certificato'
2025-04-30 11:55:36,186 - CatastoDB - INFO - Rollback eseguito.
2025-04-30 11:55:36,186 - CatastoDB - ERROR - Errore DB gen cert prop (ID: 1): ERRORE:  il record "v_partita" non ha un campo "comune_nome"
CONTEXT:  Assegnazione PL/pgSQL "v_certificato := v_certificato || 'COMUNE: ' || v_partita.comune_nome || E'\n'"
funzione PL/pgSQL genera_certificato_proprieta(integer) riga 17 a assegnazione

2025-04-30 11:55:50,315 - CatastoDB - INFO - Disconnessione completata
2025-05-02 18:32:35,377 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-02 18:32:35,470 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-02 18:36:02,083 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  Backup ID 1 non trovato
CONTEXT:  funzione PL/pgSQL get_restore_commands(integer) riga 9 a RAISE

2025-05-02 18:36:02,083 - CatastoDB - ERROR - SQLSTATE: P0001
2025-05-02 18:36:02,084 - CatastoDB - ERROR - Query renderizzata: b'SELECT get_restore_commands(1) AS command'
2025-05-02 18:36:02,085 - CatastoDB - INFO - Rollback eseguito.
2025-05-02 18:36:02,085 - CatastoDB - ERROR - Errore DB get_restore_cmd (ID: 1): ERRORE:  Backup ID 1 non trovato
CONTEXT:  funzione PL/pgSQL get_restore_commands(integer) riga 9 a RAISE

2025-05-02 18:36:20,055 - CatastoDB - INFO - Disconnessione completata
2025-05-03 08:05:18,224 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-03 08:05:18,322 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-03 08:07:20,909 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-05-03 08:10:22,632 - CatastoDB - INFO - Immobile ID 1100 trasferito a partita ID 1300.
2025-05-03 08:16:20,436 - CatastoDB - INFO - Disconnessione completata
2025-05-03 21:24:27,701 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-03 21:24:27,811 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-03 21:25:14,640 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-03 21:25:14,739 - CatastoDB - INFO - Disconnessione completata
2025-05-03 21:25:36,210 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-03 21:25:36,348 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-03 21:25:42,280 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:25:42,281 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:25:42,281 - CatastoDB - ERROR - Query renderizzata: b'CALL verifica_integrita_database(NULL)'
2025-05-03 21:25:42,282 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:25:42,282 - CatastoDB - ERROR - Errore DB verifica integrit‡: ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:25:56,889 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-03 21:25:57,519 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-03 21:26:06,730 - CatastoDB - INFO - Avvio manutenzione database (ANALYZE, REFRESH MV)...
2025-05-03 21:26:07,273 - CatastoDB - INFO - Manutenzione (ANALYZE, REFRESH MV) completata.
2025-05-03 21:26:22,292 - CatastoDB - WARNING - La funzione SQL 'analizza_query_lente' potrebbe non essere definita.
2025-05-03 21:26:22,296 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione analizza_query_lente(integer) non esiste
LINE 1: SELECT * FROM analizza_query_lente(1000)
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:26:22,297 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:26:22,297 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM analizza_query_lente(1000)'
2025-05-03 21:26:22,298 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:26:22,299 - CatastoDB - WARNING - Funzione 'analizza_query_lente' non trovata.
2025-05-03 21:26:31,898 - CatastoDB - WARNING - La procedura SQL 'controlla_frammentazione_indici' potrebbe non essere definita.
2025-05-03 21:26:31,899 - CatastoDB - INFO - Avvio controllo frammentazione indici (risultati nei log DB)...
2025-05-03 21:26:31,901 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura controlla_frammentazione_indici() non esiste
LINE 1: CALL controlla_frammentazione_indici()
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:26:31,901 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:26:31,901 - CatastoDB - ERROR - Query renderizzata: b'CALL controlla_frammentazione_indici()'
2025-05-03 21:26:31,902 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:26:31,903 - CatastoDB - WARNING - Procedura 'controlla_frammentazione_indici' non trovata.
2025-05-03 21:26:41,752 - CatastoDB - WARNING - La funzione SQL 'suggerimenti_ottimizzazione' potrebbe non essere definita o corretta.
2025-05-03 21:26:41,753 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione suggerimenti_ottimizzazione() non esiste
LINE 1: SELECT suggerimenti_ottimizzazione() AS suggestions
               ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-03 21:26:41,754 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-03 21:26:41,755 - CatastoDB - ERROR - Query renderizzata: b'SELECT suggerimenti_ottimizzazione() AS suggestions'
2025-05-03 21:26:41,755 - CatastoDB - INFO - Rollback eseguito.
2025-05-03 21:26:41,756 - CatastoDB - WARNING - Funzione 'suggerimenti_ottimizzazione' non trovata.
2025-05-03 21:27:08,485 - __main__ - WARNING - Login fallito (utente 'Saintgold' non trovato/attivo).
2025-05-03 21:27:27,589 - CatastoDB - INFO - Disconnessione completata
2025-05-12 18:10:36,884 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-12 18:10:37,007 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-12 18:11:46,941 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-12 18:11:46,942 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-12 18:11:46,943 - CatastoDB - ERROR - Query renderizzata: b'CALL verifica_integrita_database(NULL)'
2025-05-12 18:11:46,944 - CatastoDB - INFO - Rollback eseguito.
2025-05-12 18:11:46,945 - CatastoDB - ERROR - Errore DB verifica integrit‡: ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-12 18:12:04,184 - CatastoDB - INFO - Disconnessione completata
2025-05-12 18:14:20,143 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-12 18:14:20,459 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-12 18:14:56,569 - CatastoDB - INFO - Immobile ID 1 trasferito a partita ID 2.
2025-05-12 18:17:58,632 - CatastoDB - INFO - Disconnessione completata
2025-05-12 18:19:59,733 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-12 18:19:59,830 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-12 18:21:41,682 - CatastoDB - INFO - Localit‡ 'Regione Pizzaballa' (Comune ID: 6) inserita con ID: 101
2025-05-12 18:23:28,117 - CatastoDB - INFO - Localit‡ 'Regione Pizzaballa' (Comune ID: 6) inserita con ID: 102
2025-05-12 18:23:56,290 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 6, Partita N.999
2025-05-12 18:27:00,135 - CatastoDB - ERROR - Errore DB specifico rilevato: RaiseException - ERRORE:  [registra_passaggio_proprieta] Errore: La partita 999 gi√† esiste nel comune ID 6
CONTEXT:  funzione PL/pgSQL registra_passaggio_proprieta(integer,integer,integer,character varying,date,character varying,date,character varying,character varying,json,integer[],text) riga 79 a RAISE

2025-05-12 18:27:00,135 - CatastoDB - ERROR - SQLSTATE: P0001
2025-05-12 18:27:00,135 - CatastoDB - ERROR - Query renderizzata: b'CALL registra_passaggio_proprieta(1, 6, 999, \'Vendita\', \'2025-05-01\'::date, \'Vendita\', \'1950-05-01\'::date, \'Licia Col\xc3\xb2\', NULL, \'[{"nome_completo": "Alfredo O\'\'Chiatt", "cognome_nome": "Chiatto Alfredo", "paternita": "di Apulio"}]\'::json, NULL, NULL)'
2025-05-12 18:27:00,136 - CatastoDB - INFO - Rollback eseguito.
2025-05-12 18:27:00,136 - CatastoDB - ERROR - Errore DB registrazione passaggio propriet‡ (Origine ID 1): ERRORE:  [registra_passaggio_proprieta] Errore: La partita 999 gi√† esiste nel comune ID 6
CONTEXT:  funzione PL/pgSQL registra_passaggio_proprieta(integer,integer,integer,character varying,date,character varying,date,character varying,character varying,json,integer[],text) riga 79 a RAISE

2025-05-13 08:48:22,911 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 08:48:23,091 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 08:48:45,045 - CatastoDB - INFO - Disconnessione completata
2025-05-13 09:43:16,790 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 09:43:16,896 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 09:51:46,449 - CatastoDB - INFO - Disconnessione completata
2025-05-13 10:01:22,527 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 10:01:22,595 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 10:09:03,380 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-13 10:09:03,394 - CatastoDB - INFO - Disconnessione completata
2025-05-13 10:12:51,820 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-13 10:12:51,994 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-13 10:13:12,102 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la funzione get_record_history(unknown, integer) non esiste
LINE 1: SELECT * FROM get_record_history('partita', 1)
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-13 10:13:12,102 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-13 10:13:12,103 - CatastoDB - ERROR - Query renderizzata: b"SELECT * FROM get_record_history('partita', 1)"
2025-05-13 10:13:12,104 - CatastoDB - INFO - Rollback eseguito.
2025-05-13 10:13:12,104 - CatastoDB - ERROR - Errore DB get_record_history: ERRORE:  la funzione get_record_history(unknown, integer) non esiste
LINE 1: SELECT * FROM get_record_history('partita', 1)
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-13 10:13:22,239 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedTable - ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-13 10:13:22,240 - CatastoDB - ERROR - SQLSTATE: 42P01
2025-05-13 10:13:22,240 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT 1000'
2025-05-13 10:13:22,246 - CatastoDB - INFO - Rollback eseguito.
2025-05-13 10:13:22,246 - CatastoDB - ERROR - Errore DB get_audit_log: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-14 09:55:16,355 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 09:55:16,527 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 09:55:28,980 - CatastoDB - INFO - Disconnessione completata
2025-05-14 10:16:44,158 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:16:44,263 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:17:07,541 - __main__ - WARNING - Login fallito (utente 'postgres' non trovato/attivo).
2025-05-14 10:18:00,122 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:18:00,174 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:32:39,817 - CatastoDB - INFO - Avvio manutenzione database (ANALYZE, REFRESH MV)...
2025-05-14 10:54:27,621 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:54:27,680 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:55:12,311 - CatastoDB - INFO - Utente 'antongiulio' creato.
2025-05-14 10:55:27,476 - __main__ - INFO - Login OK per ID: 3
2025-05-14 10:55:27,480 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(3, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-14 10:55:27,481 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-14 10:55:27,481 - CatastoDB - ERROR - Query renderizzata: b"CALL registra_accesso(3, 'login', '127.0.0.1', NULL, true, '9fdf65fd-98b3-46fc-9e86-c990084bb894', 'CatastoApp')"
2025-05-14 10:55:27,482 - CatastoDB - INFO - Rollback eseguito.
2025-05-14 10:55:27,482 - CatastoDB - ERROR - Errore DB registrazione accesso utente ID 3: ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(3, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-14 10:55:29,044 - __main__ - ERROR - Login OK per ID 3 ma fallita reg. accesso.
2025-05-14 10:55:49,592 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-14 10:55:49,750 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-14 10:55:51,459 - CatastoDB - INFO - Disconnessione completata
2025-05-15 09:08:19,236 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 09:08:19,345 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 09:08:50,068 - CatastoDB - INFO - Disconnessione completata
2025-05-15 10:18:20,492 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 10:18:20,603 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 10:21:01,331 - CatastoDB - INFO - Disconnessione completata
2025-05-15 16:55:33,006 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 16:55:33,095 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 16:56:11,070 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-15 16:56:22,579 - __main__ - INFO - Login OK per ID: 2
2025-05-15 16:56:22,585 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 16:56:22,585 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 16:56:22,585 - CatastoDB - ERROR - Query renderizzata: b"CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, 'e02a0de5-7f71-4a76-a1da-cb381ca3ee72', 'CatastoApp')"
2025-05-15 16:56:22,586 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 16:56:22,586 - CatastoDB - ERROR - Errore DB registrazione accesso utente ID 2: ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 16:56:26,096 - __main__ - ERROR - Login OK per ID 2 ma fallita reg. accesso.
2025-05-15 17:02:18,921 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 1, Partita N.1
2025-05-15 17:04:18,647 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-15 17:04:18,780 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-15 17:04:34,619 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:00:37,205 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:00:37,305 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:03:39,684 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-05-15 18:05:51,731 - CatastoDB - INFO - Immobile ID 1 trasferito a partita ID 2.
2025-05-15 18:07:17,550 - CatastoDB - ERROR - Errore DB specifico rilevato: UniqueViolation - ERRORE:  un valore chiave duplicato viola il vincolo univoco "utente_username_key"
DETAIL:  La chiave (username)=(pippo) esiste gi‡.
CONTEXT:  istruzione SQL "INSERT INTO utente (username, password_hash, nome_completo, email, ruolo)
    VALUES (p_username, p_password, p_nome_completo, p_email, p_ruolo)"
funzione PL/pgSQL crea_utente(character varying,character varying,character varying,character varying,character varying) riga 3 a istruzione SQL

2025-05-15 18:07:17,550 - CatastoDB - ERROR - SQLSTATE: 23505
2025-05-15 18:07:17,550 - CatastoDB - ERROR - Query renderizzata: b"CALL crea_utente('pippo', '$2b$12$ATiRsJFv4Mw6Td5vgLvWWOruhEeLgQ9S/42/88D7txmAAAkMhVJ.6', 'pippo', 'pippo', 'admin')"
2025-05-15 18:07:17,551 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:07:17,551 - CatastoDB - ERROR - Errore creazione utente: Username 'pippo' o Email 'pippo' gi‡ esistente.
2025-05-15 18:07:44,539 - __main__ - INFO - Login OK per ID: 2
2025-05-15 18:07:44,541 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:07:44,541 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 18:07:44,541 - CatastoDB - ERROR - Query renderizzata: b"CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '31b9fbfa-04dc-425f-ad2c-b5c143d22f51', 'CatastoApp')"
2025-05-15 18:07:44,541 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:07:44,541 - CatastoDB - ERROR - Errore DB registrazione accesso utente ID 2: ERRORE:  la procedura registra_accesso(integer, unknown, unknown, unknown, boolean, unknown, unknown) non esiste
LINE 1: CALL registra_accesso(2, 'login', '127.0.0.1', NULL, true, '...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:07:44,542 - __main__ - ERROR - Login OK per ID 2 ma fallita reg. accesso.
2025-05-15 18:09:37,413 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:32:26,289 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:32:26,351 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:32:36,745 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1413, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-15 18:32:36,759 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:32:44,936 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:32:45,010 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:32:57,108 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 18:33:24,388 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-15 18:33:40,850 - __main__ - INFO - Login OK per ID: 3
2025-05-15 18:33:40,854 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione e367fbab...
2025-05-15 18:41:26,163 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(3, 'e367fbab-8e9e-4391-9d49-bb3e172d09b5'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:41:26,164 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 18:41:26,164 - CatastoDB - ERROR - Query renderizzata: b"CALL logout_utente(3, 'e367fbab-8e9e-4391-9d49-bb3e172d09b5', '127.0.0.1')"
2025-05-15 18:41:26,164 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:41:26,164 - CatastoDB - ERROR - Errore DB logout utente ID 3: ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(3, 'e367fbab-8e9e-4391-9d49-bb3e172d09b5'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:41:26,165 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:41:36,961 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:41:37,022 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:41:55,561 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-15 18:51:26,975 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-15 18:51:37,558 - __main__ - INFO - Login OK per ID: 4
2025-05-15 18:51:37,560 - CatastoDB - INFO - Registrato accesso: Utente ID 4, Azione login, Esito True, Sessione cea5427e...
2025-05-15 18:51:57,181 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(4, 'cea5427e-0f7f-4126-82fb-0c7832aa9e27'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:51:57,181 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-15 18:51:57,181 - CatastoDB - ERROR - Query renderizzata: b"CALL logout_utente(4, 'cea5427e-0f7f-4126-82fb-0c7832aa9e27', '127.0.0.1')"
2025-05-15 18:51:57,181 - CatastoDB - INFO - Rollback eseguito.
2025-05-15 18:51:57,181 - CatastoDB - ERROR - Errore DB logout utente ID 4: ERRORE:  la procedura logout_utente(integer, unknown, unknown) non esiste
LINE 1: CALL logout_utente(4, 'cea5427e-0f7f-4126-82fb-0c7832aa9e27'...
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-15 18:51:57,182 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:58:36,051 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:58:36,114 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:58:38,358 - CatastoDB - INFO - Disconnessione completata
2025-05-15 18:58:47,269 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 18:58:47,331 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 18:59:06,467 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-15 19:00:21,099 - CatastoDB - INFO - Registrata consultazione: Richiedente 'Antongiulio', Data 2025-05-15
2025-05-15 19:01:01,878 - __main__ - ERROR - Errore non gestito nel menu principale: cannot access local variable 'utente_db' where it is not associated with a value
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1439, in main
    menu_principale(db)
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 303, in menu_principale
    elif scelta == "5": menu_audit(db)
                        ~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in menu_audit
    logs = db.get_audit_log(tabella, op, rec_id, data_inizio, data_fine, utente_db, app_user_id, session_id_str)
                                                                         ^^^^^^^^^
UnboundLocalError: cannot access local variable 'utente_db' where it is not associated with a value
2025-05-15 19:01:01,893 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:01:49,728 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:01:49,790 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:02:02,792 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:02:02,803 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione ab67a918...
2025-05-15 19:06:08,632 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione ab67a918...
2025-05-15 19:06:08,632 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:06:19,457 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:06:19,518 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:06:30,804 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-15 19:06:31,024 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:06:31,040 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 15dcd4f7...
2025-05-15 19:14:06,321 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 15dcd4f7...
2025-05-15 19:14:06,322 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:14:10,535 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:14:10,597 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:14:28,837 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-15 19:14:29,059 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:14:29,070 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 525ef173...
2025-05-15 19:18:46,143 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:46,149 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione d9bbb2bc...
2025-05-15 19:18:48,207 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:48,208 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione bea41487...
2025-05-15 19:18:51,391 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:51,392 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 342dbddc...
2025-05-15 19:18:59,415 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:18:59,421 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 7a5ab7da...
2025-05-15 19:19:04,920 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 7a5ab7da...
2025-05-15 19:19:04,921 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:19:07,809 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:19:07,978 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:19:29,569 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-15 19:19:29,789 - __main__ - INFO - Login OK per ID: 3
2025-05-15 19:19:29,818 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 4ddb62ce...
2025-05-15 19:19:42,383 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:19:42,384 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione db86bb78...
2025-05-15 19:19:47,687 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:19:47,688 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione f333211d...
2025-05-15 19:19:50,288 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:19:50,293 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione e19876ef...
2025-05-15 19:20:04,463 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:04,464 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 367dbf16...
2025-05-15 19:20:14,567 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:14,573 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione ac97f7a4...
2025-05-15 19:20:16,655 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:16,656 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 6720ba51...
2025-05-15 19:20:22,951 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:20:22,952 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 47816622...
2025-05-15 19:26:36,147 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-15 19:26:36,153 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 78ecdfe7...
2025-05-15 19:26:37,710 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 78ecdfe7...
2025-05-15 19:26:37,712 - CatastoDB - INFO - Disconnessione completata
2025-05-15 19:27:30,067 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-15 19:27:30,227 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-15 19:27:38,409 - CatastoDB - INFO - Disconnessione completata
2025-05-16 15:50:16,398 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 15:50:16,506 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 15:50:23,862 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-16 15:50:24,294 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 7fe0f6b5...
2025-05-16 15:50:58,203 - __main__ - INFO - Uscita inattesa da menu_principale con utente ancora loggato. Terminazione.
2025-05-16 16:05:54,704 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:05:54,776 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:06:02,540 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-16 16:06:02,893 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 4764c31e...
2025-05-16 16:06:13,014 - CatastoDB - INFO - Disconnessione completata
2025-05-16 16:06:15,780 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:06:15,847 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:06:22,098 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-16 16:06:22,499 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 1efdf3e3...
2025-05-16 16:06:33,594 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedTable - ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-16 16:06:33,594 - CatastoDB - ERROR - SQLSTATE: 42P01
2025-05-16 16:06:33,595 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT 100'
2025-05-16 16:06:33,595 - CatastoDB - INFO - Rollback eseguito.
2025-05-16 16:06:33,596 - CatastoDB - ERROR - Errore DB get_audit_log: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-16 16:07:34,241 - __main__ - WARNING - Login fallito (utente 'santoro' non trovato/attivo).
2025-05-16 16:26:25,654 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:26:25,889 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:27:50,640 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 16:28:14,694 - CatastoDB - INFO - Disconnessione completata
2025-05-16 16:34:05,083 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:34:05,195 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:34:21,117 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 16:35:23,986 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 16:35:24,091 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 16:35:26,019 - CatastoDB - INFO - Disconnessione completata
2025-05-16 17:20:21,722 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 17:20:21,936 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 17:22:51,384 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 17:22:51,614 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 17:22:56,590 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 17:23:04,689 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 17:23:09,328 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 17:23:09,343 - CatastoDB - INFO - Disconnessione completata
2025-05-16 18:31:04,322 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 18:31:04,528 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 18:31:10,973 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-16 18:31:11,065 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-16 18:31:11,157 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-16 18:31:11,257 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 8fcda1f7...
2025-05-16 18:31:27,787 - __main__ - WARNING - Login fallito (utente 'santoro' non trovato/attivo).
2025-05-16 18:31:40,419 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-16 18:31:40,519 - CatastoDB - INFO - Disconnessione completata
2025-05-16 18:31:58,196 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-16 18:31:58,343 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-16 18:32:09,421 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-16 18:32:09,426 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-16 18:32:09,433 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-16 18:32:09,441 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 506e56e1...
2025-05-16 18:32:15,606 - CatastoDB - INFO - Disconnessione completata
2025-05-17 07:38:34,710 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 07:38:34,850 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 07:38:43,239 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-17 07:38:44,269 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione d326ab53...
2025-05-17 07:40:24,653 - __main__ - ERROR - Errore non gestito nel programma: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1091, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1045, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 365, in menu_consultazione
    results_possessori = db.ricerca_avanzata_possessori(query_text, similarity_threshold=soglia) # Rinominato
TypeError: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
2025-05-17 07:40:24,764 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione d326ab53...
2025-05-17 07:40:24,766 - CatastoDB - INFO - Disconnessione completata
2025-05-17 07:40:42,226 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 07:40:42,308 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 07:40:47,416 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-17 07:40:48,340 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 3b8b1a59...
2025-05-17 07:41:01,982 - CatastoDB - INFO - Recuperati 4 utenti.
2025-05-17 07:41:32,824 - CatastoDB - INFO - Disconnessione completata
2025-05-17 08:09:28,930 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 08:09:29,098 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 08:09:34,693 - CatastoDB - INFO - Credenziali recuperate per utente: pippo
2025-05-17 08:09:35,608 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione c8a9ed1c...
2025-05-17 08:10:25,737 - CatastoDB - INFO - Recuperati 4 utenti.
2025-05-17 08:11:08,516 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 08:11:08,516 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 08:11:08,517 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 08:11:08,519 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 1a52a2cc...
2025-05-17 08:11:15,447 - CatastoDB - INFO - Credenziali recuperate per utente: sa
2025-05-17 08:11:16,370 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 470f2a75...
2025-05-17 08:12:50,871 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedFunction - ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-17 08:12:50,873 - CatastoDB - ERROR - SQLSTATE: 42883
2025-05-17 08:12:50,874 - CatastoDB - ERROR - Query renderizzata: b'CALL verifica_integrita_database(NULL)'
2025-05-17 08:12:50,875 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 08:12:50,876 - CatastoDB - ERROR - Errore DB verifica integrit‡: ERRORE:  la procedura verifica_integrita_database(unknown) non esiste
LINE 1: CALL verifica_integrita_database(NULL)
             ^
HINT:  Nessuna procedura trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-17 08:13:36,344 - CatastoDB - ERROR - Errore DB specifico rilevato: UndefinedTable - ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-17 08:13:36,345 - CatastoDB - ERROR - SQLSTATE: 42P01
2025-05-17 08:13:36,345 - CatastoDB - ERROR - Query renderizzata: b'SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT 100'
2025-05-17 08:13:36,346 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 08:13:36,346 - CatastoDB - ERROR - Errore DB get_audit_log: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-17 08:15:05,561 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:37:28,649 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:37:28,785 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:37:33,759 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-17 10:37:42,947 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-17 10:37:45,803 - __main__ - WARNING - Login fallito (utente 'sa' non trovato/attivo).
2025-05-17 10:37:45,810 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:37:49,738 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:37:49,950 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:37:58,150 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:37:58,155 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:37:58,161 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:37:58,187 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 726ef06b...
2025-05-17 10:38:05,891 - __main__ - WARNING - Login fallito (utente 'Admin' non trovato/attivo).
2025-05-17 10:38:08,590 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:46:02,315 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:46:02,429 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:46:07,756 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:46:07,762 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:46:07,767 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:46:07,776 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione ee1520c8...
2025-05-17 10:47:51,238 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:49:32,624 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:49:32,838 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:49:38,414 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:49:38,419 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:49:38,425 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:49:38,435 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione a6b9839b...
2025-05-17 10:49:43,918 - CatastoDB - INFO - Disconnessione completata
2025-05-17 10:55:55,175 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 10:55:55,288 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 10:56:01,153 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:56:01,158 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:56:01,164 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:56:01,173 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 5420aba4...
2025-05-17 10:56:19,359 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:56:19,365 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:56:19,370 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:56:19,377 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 69f6dc22...
2025-05-17 10:56:30,311 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 10:56:30,317 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 10:56:30,323 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 10:56:30,329 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 2fa2180c...
2025-05-17 10:56:30,338 - CatastoDB - INFO - Disconnessione completata
2025-05-17 11:12:53,920 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 11:12:54,160 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 11:12:59,079 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 11:12:59,335 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 11:12:59,344 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 60c27911...
2025-05-17 11:13:13,917 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 11:13:14,194 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 11:13:14,201 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 5b821f4a...
2025-05-17 11:13:18,975 - CatastoDB - INFO - Disconnessione completata
2025-05-17 11:30:29,297 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 11:30:29,415 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 11:30:35,851 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 11:30:36,114 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 76495234...
2025-05-17 12:32:06,194 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:32:10,796 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:32:10,966 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:32:21,770 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:32:51,118 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:32:51,229 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:32:55,842 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 12:32:55,865 - __main__ - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-17 12:32:55,881 - __main__ - WARNING - Login fallito (pwd errata) per user ID: 1
2025-05-17 12:32:55,913 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito False, Sessione 38a8a2d6...
2025-05-17 12:33:13,907 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:58:24,947 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:58:25,114 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:58:30,362 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 12:58:30,627 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 39443c3d...
2025-05-17 12:58:42,609 - CatastoDB - INFO - Disconnessione completata
2025-05-17 12:59:23,405 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 12:59:23,622 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 12:59:27,827 - CatastoDB - INFO - Credenziali recuperate per utente: admin
2025-05-17 12:59:28,091 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 898a5ae2...
2025-05-17 12:59:44,032 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-17 13:09:16,531 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:10:16,820 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:10:17,037 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:10:20,905 - __main__ - ERROR - Errore non gestito nel programma: 'CatastoDBManager' object has no attribute 'get_user_credentials'
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 1255, in main
    if not esegui_login(db):
           ~~~~~~~~~~~~^^^^
  File "U:\catasto\gemini\python_example.py", line 159, in esegui_login
    credentials = db.get_user_credentials(username_login) # Assumiamo restituisca id, username, password_hash, nome_completo
                  ^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'get_user_credentials'
2025-05-17 13:10:21,057 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:11:45,117 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:11:45,246 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:11:50,261 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 13:11:50,522 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1bd89b5d...
2025-05-17 13:12:53,254 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:12:55,982 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:12:56,200 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:13:00,727 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 13:13:00,987 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 13f3bedd...
2025-05-17 13:13:37,321 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-17 13:13:52,359 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 13:14:33,554 - __main__ - ERROR - Errore non gestito nel programma: _seleziona_utente_da_elenco() got an unexpected keyword argument 'exclude_user_id'
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 1259, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "U:\catasto\gemini\python_example.py", line 1219, in menu_principale
    utente_ancora_loggato = menu_utenti(db) # menu_utenti ora restituisce False se l'utente fa logout
  File "U:\catasto\gemini\python_example.py", line 1113, in menu_utenti
    user_id_to_toggle = _seleziona_utente_da_elenco(db, "Seleziona l'utente da disattivare/riattivare:", exclude_user_id=logged_in_user_id)
TypeError: _seleziona_utente_da_elenco() got an unexpected keyword argument 'exclude_user_id'
2025-05-17 13:14:33,701 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 13f3bedd...
2025-05-17 13:14:33,707 - CatastoDB - INFO - Disconnessione completata
2025-05-17 13:18:00,436 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 13:18:00,573 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 13:18:05,067 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-17 13:18:05,342 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 5ad54c9c...
2025-05-17 13:18:09,569 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 13:18:39,153 - CatastoDB - INFO - Disconnessione completata
2025-05-17 15:15:09,210 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 15:15:09,342 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 15:15:14,404 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 15:15:14,670 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9d865890...
2025-05-17 15:15:26,824 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 15:16:00,654 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-17 15:16:08,584 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:16:17,609 - CatastoDB - INFO - Disconnessione completata
2025-05-17 15:40:23,007 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 15:40:23,120 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 15:40:27,435 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: pippo, Ruolo: consultatore
2025-05-17 15:40:27,710 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 791271c0...
2025-05-17 15:40:35,707 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:40:55,999 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 791271c0...
2025-05-17 15:41:04,370 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-17 15:41:04,628 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 981daba6...
2025-05-17 15:41:13,452 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:41:40,616 - CatastoDB - INFO - Dettagli utente ID 3 aggiornati.
2025-05-17 15:41:49,265 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:42:18,129 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:42:33,527 - CatastoDB - INFO - Password resettata per utente ID 3.
2025-05-17 15:42:40,823 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 981daba6...
2025-05-17 15:42:43,461 - CatastoDB - INFO - Disconnessione completata
2025-05-17 15:42:48,084 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 15:42:48,294 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 15:42:53,920 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: pippo, Ruolo: archivista
2025-05-17 15:42:54,182 - CatastoDB - INFO - Registrato accesso: Utente ID 3, Azione login, Esito True, Sessione 9210f438...
2025-05-17 15:43:54,538 - CatastoDB - INFO - Logout registrato per utente ID 3, sessione 9210f438...
2025-05-17 15:44:03,551 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-17 15:44:03,812 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 9e449315...
2025-05-17 15:44:19,380 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:44:25,139 - CatastoDB - INFO - Utente ID 3 disattivato.
2025-05-17 15:44:45,806 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 15:44:52,338 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 9e449315...
2025-05-17 15:45:00,335 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-17 15:45:44,623 - CatastoDB - INFO - Disconnessione completata
2025-05-17 16:39:05,827 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 16:39:06,076 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 16:39:12,579 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 16:39:12,851 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9ceef3a7...
2025-05-17 16:39:30,844 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-17 16:39:47,140 - CatastoDB - ERROR - Errore DB specifico rilevato: ForeignKeyViolation - ERRORE:  l'istruzione UPDATE o DELETE sulla tabella "utente" viola il vincolo di chiave esterna "accesso_log_utente_id_fkey" sulla tabella "accesso_log"
DETAIL:  La chiave (id)=(3) Ë ancora referenziata dalla tabella "accesso_log".

2025-05-17 16:39:47,146 - CatastoDB - ERROR - SQLSTATE: 23503
2025-05-17 16:39:47,151 - CatastoDB - ERROR - Query renderizzata: b'DELETE FROM utente WHERE id = 3'
2025-05-17 16:39:47,157 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 16:39:47,162 - CatastoDB - ERROR - Errore DB durante l'eliminazione fisica dell'utente ID 3: ERRORE:  l'istruzione UPDATE o DELETE sulla tabella "utente" viola il vincolo di chiave esterna "accesso_log_utente_id_fkey" sulla tabella "accesso_log"
DETAIL:  La chiave (id)=(3) Ë ancora referenziata dalla tabella "accesso_log".

2025-05-17 16:39:47,168 - CatastoDB - INFO - Rollback eseguito.
2025-05-17 16:42:02,140 - CatastoDB - INFO - Disconnessione completata
2025-05-17 16:44:38,584 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 16:44:38,701 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 16:44:44,992 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 16:44:45,252 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 629b832d...
2025-05-17 16:45:15,691 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-17 16:45:28,578 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 16:45:43,297 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-17 16:45:56,940 - CatastoDB - INFO - Utente ID 2 eliminato fisicamente con successo.
2025-05-17 16:46:39,938 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-17 16:48:29,107 - __main__ - INFO - Uscita inattesa da menu_principale con utente ancora loggato. Terminazione.
2025-05-17 16:48:29,117 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 629b832d...
2025-05-17 16:48:29,124 - CatastoDB - INFO - Disconnessione completata
2025-05-17 18:34:21,888 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 18:34:22,022 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 18:34:28,971 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 18:34:29,232 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1e6f20ed...
2025-05-17 18:34:53,935 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 1e6f20ed...
2025-05-17 18:35:06,271 - CatastoDB - INFO - Disconnessione completata
2025-05-17 18:38:33,965 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 18:38:34,078 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 18:38:39,024 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 18:38:39,289 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b1b57cd0...
2025-05-17 18:49:13,664 - CatastoDB - INFO - Disconnessione completata
2025-05-17 18:49:41,725 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 18:49:41,838 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 18:49:51,409 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 18:49:51,671 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 96252fa3...
2025-05-17 18:50:30,053 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 318, in _esporta_partita_pdf
    pdf.chapter_body({
    ~~~~~~~~~~~~~~~~^^
        'ID Partita': p.get('id'), 'Comune': p.get('comune_nome'),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<2 lines>...
        'Data Chiusura': p.get('data_chiusura')
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    })
    ^^
  File "U:\catasto\gemini\python_example.py", line 289, in chapter_body
    self.multi_cell(0, 5, f"{key.replace('_', ' ').title()}: {value if value is not None else 'N/D'}")
    ~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 221, in wrapper
    return fn(self, *args, **kwargs)
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\deprecation.py", line 32, in wrapper
    return fn(self, *args, **kwargs)
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 4172, in multi_cell
    text_line = multi_line_break.get_line()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\line_break.py", line 792, in get_line
    raise FPDFException(
        "Not enough horizontal space to render a single character"
    )
fpdf.errors.FPDFException: Not enough horizontal space to render a single character
2025-05-17 19:52:11,842 - CatastoDB - INFO - Disconnessione completata
2025-05-17 19:52:16,838 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 19:52:16,952 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 19:52:22,137 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 19:52:22,400 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 45b40f39...
2025-05-17 19:52:36,112 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 323, in _esporta_partita_pdf
    pdf.add_page()
    ~~~~~~~~~~~~^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 1079, in add_page
    self.header()
    ~~~~~~~~~~~^^
  File "U:\catasto\gemini\python_example.py", line 273, in header
    self.cell(0, 10, 'Dettaglio Partita Catastale', 0, new_x=XPos.LMARGIN, new_y=YPos.NEXT, align='C')
                                                             ^^^^
NameError: name 'XPos' is not defined
2025-05-17 19:54:26,393 - CatastoDB - INFO - Disconnessione completata
2025-05-17 19:54:31,456 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 19:54:31,669 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 19:54:39,137 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 19:54:39,406 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 76f9ef99...
2025-05-17 19:56:23,832 - CatastoDB - INFO - Disconnessione completata
2025-05-17 19:56:29,869 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 19:56:29,988 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 19:56:34,584 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 19:56:34,848 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e16be22a...
2025-05-17 19:56:45,089 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 353, in _esporta_partita_pdf
    pdf.output(filename, 'F')
    ~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 5659, in output
    Path(name).write_bytes(self.buffer)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_abc.py", line 641, in write_bytes
    with self.open(mode='wb') as f:
         ~~~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_local.py", line 537, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'partita_1540_2025-05-17.pdf'
2025-05-17 19:57:03,668 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 353, in _esporta_partita_pdf
    pdf.output(filename, 'F')
    ~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 5659, in output
    Path(name).write_bytes(self.buffer)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_abc.py", line 641, in write_bytes
    with self.open(mode='wb') as f:
         ~~~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_local.py", line 537, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'partita_1540_2025-05-17.pdf'
2025-05-17 20:00:11,001 - CatastoDB - INFO - Disconnessione completata
2025-05-17 20:13:19,958 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-17 20:13:20,199 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-17 20:15:18,266 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-17 20:15:18,546 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6cae06e3...
2025-05-17 20:15:29,898 - __main__ - ERROR - Errore esportazione PDF partita
Traceback (most recent call last):
  File "U:\catasto\gemini\python_example.py", line 411, in _esporta_partita_pdf
    pdf.output(filename) # Rimosso 'F'
    ^^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\fpdf\fpdf.py", line 5659, in output
    Path(name).write_bytes(self.buffer)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_abc.py", line 641, in write_bytes
    with self.open(mode='wb') as f:
         ~~~~~~~~~^^^^^^^^^^^
  File "C:\Python313\Lib\pathlib\_local.py", line 537, in open
    return io.open(self, mode, buffering, encoding, errors, newline)
           ~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
PermissionError: [Errno 13] Permission denied: 'partita_1540_2025-05-17.pdf'
2025-05-17 20:16:26,416 - CatastoDB - INFO - Disconnessione completata
2025-05-18 11:55:04,983 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 11:55:05,126 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 11:55:12,190 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 11:55:12,449 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 11:55:12,476 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b57f8306...
2025-05-18 11:57:20,078 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 11:57:20,188 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 11:57:25,245 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-18 11:57:25,257 - CatastoDB - INFO - Disconnessione completata
2025-05-18 11:57:35,034 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 11:57:35,172 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 11:57:41,273 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 11:57:41,527 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 11:57:41,536 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1e8bd154...
2025-05-18 11:57:43,223 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 11:59:50,403 - CatastoDB - INFO - Localit‡ 'Borgata Sarcazzo' (Comune ID: 3) inserita con ID: 101
2025-05-18 12:01:01,370 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 3, Partita N.1
2025-05-18 12:01:55,848 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-18 12:01:56,024 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-18 12:05:41,601 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 12:05:41,710 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 12:05:49,041 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 12:05:49,308 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 12:05:49,317 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f32db834...
2025-05-18 12:05:51,313 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 12:06:15,007 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-18 12:06:16,248 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-18 12:06:32,979 - CatastoDB - INFO - Utente ID 3 eliminato fisicamente con successo.
2025-05-18 12:06:33,790 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 12:25:51,222 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 12:25:51,372 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 12:25:59,644 - CatastoGUI - WARNING - Login GUI fallito (utente 'santoro' non trovato/attivo).
2025-05-18 12:26:09,023 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 12:26:09,290 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 12:26:09,304 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione daf1d77e...
2025-05-18 12:26:11,072 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 12:31:07,698 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione daf1d77e...
2025-05-18 12:31:09,337 - CatastoDB - INFO - Disconnessione completata
2025-05-18 12:31:09,346 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-18 14:48:08,500 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 14:48:08,644 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 14:48:16,032 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 14:48:16,282 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 14:48:16,302 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ac2bf37f...
2025-05-18 14:48:18,446 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 14:50:59,243 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione ac2bf37f...
2025-05-18 14:51:00,509 - CatastoDB - INFO - Disconnessione completata
2025-05-18 14:51:00,514 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-18 15:17:02,056 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 15:17:02,160 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 15:17:07,848 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 15:17:08,103 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-18 15:17:08,112 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6218f953...
2025-05-18 15:17:09,144 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-18 15:17:22,980 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-18 15:17:23,128 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-18 15:17:27,085 - CatastoDB - INFO - Avvio manutenzione database (ANALYZE, REFRESH MV)...
2025-05-18 15:17:27,293 - CatastoDB - INFO - Manutenzione (ANALYZE, REFRESH MV) completata.
2025-05-18 15:55:50,574 - CatastoGUI - INFO - Esecuzione logout di sicurezza per utente ID: 1 prima della chiusura...
2025-05-18 15:55:50,588 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 6218f953...
2025-05-18 15:55:50,595 - CatastoDB - INFO - Disconnessione completata
2025-05-18 15:55:50,600 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-18 15:56:35,852 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 15:56:35,980 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 15:56:41,881 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 15:56:42,142 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione cf80e6cd...
2025-05-18 16:16:53,288 - CatastoDB - INFO - Disconnessione completata
2025-05-18 16:38:58,010 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-18 16:38:58,118 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-18 16:39:02,470 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-18 16:39:02,732 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 68812a4a...
2025-05-18 16:39:12,466 - CatastoDB - WARNING - Nessun dato trovato per possessore ID 1 per l'esportazione.
2025-05-18 16:39:36,326 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:13:37,487 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 08:13:37,644 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 08:13:45,809 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:13:45,810 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:13:47,350 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:13:58,391 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:13:58,391 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:13:59,371 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:03,964 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:03,965 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:04,845 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:10,901 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:10,902 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:11,789 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:13,953 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-19 08:14:13,962 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:14:46,584 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 08:14:46,679 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 08:14:53,596 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:53,597 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:54,776 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:14:59,262 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:14:59,263 - CatastoGUI - ERROR - Tentativo di verifica con hash non valido: password_h...
2025-05-19 08:14:59,966 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-19 08:15:03,736 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-19 08:15:03,741 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:18:36,245 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 08:18:36,350 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 08:18:42,778 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 08:18:43,137 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 08:18:43,161 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3e7e7d30...
2025-05-19 08:18:46,165 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 08:22:24,920 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3e7e7d30...
2025-05-19 08:22:26,188 - CatastoDB - INFO - Disconnessione completata
2025-05-19 08:22:26,188 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 09:08:37,870 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:08:38,002 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:08:39,805 - CatastoGUI - INFO - Login annullato o fallito. Uscita dall'applicazione GUI.
2025-05-19 09:08:39,814 - CatastoDB - INFO - Disconnessione completata
2025-05-19 09:09:14,778 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:09:14,980 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:09:23,050 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:09:23,365 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 09:09:23,418 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 64d56f80...
2025-05-19 09:09:25,612 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 09:10:15,222 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:10:15,361 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:10:22,469 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:10:22,848 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 09:10:22,897 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e74aae32...
2025-05-19 09:10:24,900 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 09:11:25,210 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:11:25,339 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:11:31,461 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:11:32,606 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 92c11af7...
2025-05-19 09:11:59,567 - CatastoDB - INFO - Disconnessione completata
2025-05-19 09:16:21,436 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 09:16:21,555 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 09:16:32,452 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 09:16:32,774 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 09:16:32,852 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a8d52b34...
2025-05-19 09:16:35,219 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 09:18:25,232 - CatastoGUI - INFO - Esecuzione logout di sicurezza per utente ID: 1 prima della chiusura...
2025-05-19 09:18:25,252 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione a8d52b34...
2025-05-19 09:18:25,255 - CatastoDB - INFO - Disconnessione completata
2025-05-19 09:18:25,255 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 10:01:36,819 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:01:37,061 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:01:44,597 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 10:01:44,895 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 10:01:44,966 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione d4f9e151...
2025-05-19 10:01:46,937 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 10:02:43,539 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:02:43,608 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:02:50,067 - __main__ - WARNING - Login fallito (utente 'santoro' non trovato/attivo).
2025-05-19 10:02:58,556 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 10:02:59,006 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5372b372...
2025-05-19 10:03:05,129 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 10:03:37,382 - CatastoDB - INFO - Utente 'santoro' creato.
2025-05-19 10:03:42,205 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-19 10:03:52,630 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:03:55,364 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:03:55,430 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:03:58,847 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:03:59,301 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione a5920a65...
2025-05-19 10:04:06,150 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:04:09,567 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:04:09,634 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:04:14,793 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:04:15,082 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 10:04:15,089 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione c8d0e29d...
2025-05-19 10:04:16,397 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-19 10:04:46,852 - CatastoDB - INFO - Password resettata per utente ID 1.
2025-05-19 10:10:51,867 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:10:51,953 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:10:57,335 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:10:57,629 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 10:10:57,680 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 434647ec...
2025-05-19 10:10:59,213 - CatastoDB - INFO - Recuperati 2 utenti.
2025-05-19 10:11:47,354 - CatastoDB - INFO - Utente 'pippo' creato.
2025-05-19 10:11:48,623 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 10:12:24,748 - CatastoDB - INFO - Utente ID 3 disattivato.
2025-05-19 10:12:25,944 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 10:12:39,287 - CatastoDB - INFO - Dettagli utente ID 3 aggiornati.
2025-05-19 10:12:40,322 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 10:13:06,856 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 434647ec...
2025-05-19 10:13:08,005 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:13:08,005 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 10:37:31,433 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:37:31,514 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:37:41,395 - __main__ - WARNING - Login fallito (utente 'pippo' non trovato/attivo).
2025-05-19 10:37:49,198 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:37:49,609 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 021d5327...
2025-05-19 10:55:35,319 - __main__ - ERROR - Errore non gestito nel programma: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1733, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1687, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 728, in menu_consultazione
    results_possessori = db.ricerca_avanzata_possessori(query_text, similarity_threshold=soglia) # Rinominato
TypeError: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
2025-05-19 10:55:35,363 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 021d5327...
2025-05-19 10:55:35,365 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:55:38,737 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:55:38,809 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:55:42,382 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:55:42,774 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 508703e0...
2025-05-19 10:55:50,096 - __main__ - ERROR - Errore non gestito nel programma: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1733, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 1687, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\python_example.py", line 728, in menu_consultazione
    results_possessori = db.ricerca_avanzata_possessori(query_text, similarity_threshold=soglia) # Rinominato
TypeError: CatastoDBManager.ricerca_avanzata_possessori() got an unexpected keyword argument 'similarity_threshold'
2025-05-19 10:55:50,125 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 508703e0...
2025-05-19 10:55:50,128 - CatastoDB - INFO - Disconnessione completata
2025-05-19 10:58:56,621 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 10:58:56,704 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 10:59:00,355 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 10:59:00,754 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 936c6b79...
2025-05-19 10:59:07,027 - CatastoDB - WARNING - La funzione SQL 'ricerca_avanzata_immobili' potrebbe non essere definita o aggiornata per comune_id.
2025-05-19 10:59:17,077 - CatastoDB - ERROR - Errore Python imprevisto durante la ricerca avanzata dei possessori: 'CatastoDBManager' object has no attribute 'fetch_all_dict'
2025-05-19 11:02:02,115 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:02:04,894 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:02:04,963 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:02:10,217 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:02:10,638 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 45e134df...
2025-05-19 11:02:18,206 - CatastoDB - ERROR - Errore DB durante la ricerca avanzata dei possessori: ERRORE:  la funzione catasto.search_possessori_advanced(unknown, unknown, numeric) non esiste
LINE 1: SELECT * FROM catasto.search_possessori_advanced('2-97', NUL...
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-19 11:02:18,207 - CatastoDB - INFO - Rollback eseguito.
2025-05-19 11:05:11,647 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:05:32,706 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:05:32,828 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:05:36,967 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:05:37,388 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 03930a43...
2025-05-19 11:05:43,519 - CatastoDB - ERROR - Errore DB durante la ricerca avanzata dei possessori: ERRORE:  la funzione catasto.search_possessori_advanced(unknown, unknown, real) non esiste
LINE 1: SELECT * FROM catasto.search_possessori_advanced('2-97', NUL...
                      ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-19 11:05:43,520 - CatastoDB - INFO - Rollback eseguito.
2025-05-19 11:06:01,110 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:18:57,085 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:18:57,152 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:19:00,703 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:19:01,044 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 6708e445...
2025-05-19 11:19:13,506 - CatastoDB - ERROR - Errore Python imprevisto durante la ricerca avanzata dei possessori: name 'comune_id' is not defined
2025-05-19 11:23:54,089 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:23:57,388 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:23:57,488 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:24:01,894 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:24:02,288 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione bb837c88...
2025-05-19 11:24:09,478 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.2).
2025-05-19 11:24:35,464 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.0).
2025-05-19 11:24:50,084 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.2) ha prodotto 95 risultati.
2025-05-19 11:27:22,878 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:32:36,466 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 11:32:36,535 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 11:32:44,033 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 11:32:44,332 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 11:32:44,340 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 4158b7fc...
2025-05-19 11:32:46,686 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 11:59:26,406 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 4158b7fc...
2025-05-19 11:59:27,937 - CatastoDB - INFO - Disconnessione completata
2025-05-19 11:59:27,937 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 12:08:48,431 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 12:08:48,545 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 12:08:56,756 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 12:08:57,050 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 12:08:57,092 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 6689471d...
2025-05-19 12:08:58,162 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 12:09:09,932 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.2).
2025-05-19 12:09:16,770 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-97' (soglia: 0.0).
2025-05-19 12:09:26,475 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.0) ha prodotto 95 risultati.
2025-05-19 12:09:36,759 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '3-3' (soglia: 0.0).
2025-05-19 12:09:46,799 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '3-3' (soglia: 0.0).
2025-05-19 12:10:00,957 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.0) ha prodotto 95 risultati.
2025-05-19 12:10:17,776 - CatastoDB - INFO - Ricerca avanzata possessori per '5-1 rossi' (soglia: 0.0) ha prodotto 100 risultati.
2025-05-19 12:10:47,004 - CatastoDB - INFO - Ricerca avanzata possessori per 'possessore' (soglia: 0.0) ha prodotto 100 risultati.
2025-05-19 12:10:55,721 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 0.0).
2025-05-19 12:10:59,494 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 1.0).
2025-05-19 12:11:09,904 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: 'stress' (soglia: 1.0).
2025-05-19 12:11:17,136 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.24999999999999967) ha prodotto 100 risultati.
2025-05-19 12:11:27,120 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-62' (soglia: 0.24999999999999967).
2025-05-19 12:15:33,270 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 1' (soglia: 0.24999999999999967) ha prodotto 100 risultati.
2025-05-19 12:15:43,249 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 1' (soglia: 1.0) ha prodotto 5 risultati.
2025-05-19 12:54:36,432 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 12:54:36,710 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 12:54:46,136 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 12:54:46,464 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 12:54:46,505 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione b9c4f1e3...
2025-05-19 12:54:51,147 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 12:55:57,766 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '101' (soglia: 0.3).
2025-05-19 12:56:05,677 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 0.3).
2025-05-19 12:56:17,670 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 0.01).
2025-05-19 12:57:16,749 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-1' (soglia: 0.01).
2025-05-19 12:57:23,053 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '2-1' (soglia: 0.0).
2025-05-19 12:57:34,172 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 1' (soglia: 0.0) ha prodotto 100 risultati.
2025-05-19 13:14:19,229 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione b9c4f1e3...
2025-05-19 13:14:20,779 - CatastoDB - INFO - Disconnessione completata
2025-05-19 13:14:20,783 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 13:20:01,481 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 13:20:01,598 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 13:20:10,181 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 13:20:10,539 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 13:20:10,560 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione e57f394a...
2025-05-19 13:20:13,701 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 13:20:51,893 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-19 13:29:06,388 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione e57f394a...
2025-05-19 13:29:07,952 - CatastoDB - INFO - Disconnessione completata
2025-05-19 13:29:07,952 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 13:30:24,963 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 13:30:25,067 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 13:30:34,759 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: santoro, Ruolo: admin
2025-05-19 13:30:35,095 - CatastoGUI - INFO - Login GUI OK per ID: 2
2025-05-19 13:30:35,140 - CatastoDB - INFO - Registrato accesso: Utente ID 2, Azione login, Esito True, Sessione 2f01fc8a...
2025-05-19 13:30:36,360 - CatastoDB - INFO - Recuperati 3 utenti.
2025-05-19 13:30:44,604 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-19 13:31:07,252 - CatastoDB - INFO - Logout registrato per utente ID 2, sessione 2f01fc8a...
2025-05-19 13:31:08,623 - CatastoDB - INFO - Disconnessione completata
2025-05-19 13:31:08,623 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 13:37:20,925 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 13:37:21,145 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 13:37:29,890 - CatastoGUI - WARNING - Login GUI fallito (utente 'santoro' non trovato/attivo).
2025-05-19 13:37:35,558 - CatastoGUI - WARNING - Login GUI fallito (utente 'santoro' non trovato/attivo).
2025-05-19 13:37:42,723 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 13:37:43,032 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 13:37:43,083 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 88e85daa...
2025-05-19 13:37:44,342 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 13:37:52,977 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-19 13:38:14,537 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 4' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-19 13:38:27,177 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress 4' (soglia: 0.9000000000000002) ha prodotto 5 risultati.
2025-05-19 13:38:38,131 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: 'possessore 1' (soglia: 0.9000000000000002).
2025-05-19 13:38:44,340 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: 'possessore 1-1' (soglia: 0.9000000000000002).
2025-05-19 13:38:50,933 - CatastoDB - INFO - Ricerca avanzata possessori per 'possessore 1-1' (soglia: 0.15000000000000002) ha prodotto 100 risultati.
2025-05-19 13:39:00,690 - CatastoDB - INFO - Ricerca avanzata possessori per '1-1' (soglia: 0.15000000000000002) ha prodotto 5 risultati.
2025-05-19 13:39:08,874 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 0.44999999999999996).
2025-05-19 13:39:13,691 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: '1-1' (soglia: 0.3).
2025-05-19 13:39:16,817 - CatastoDB - INFO - Ricerca avanzata possessori per '1-1' (soglia: 0.2) ha prodotto 5 risultati.
2025-05-19 13:39:26,842 - CatastoDB - INFO - Ricerca avanzata possessori per '1-1' (soglia: 0.05000000000000002) ha prodotto 100 risultati.
2025-05-19 13:39:36,700 - CatastoDB - INFO - Ricerca avanzata possessori per '1-1' (soglia: 0.2) ha prodotto 5 risultati.
2025-05-19 13:39:49,387 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 88e85daa...
2025-05-19 13:39:50,773 - CatastoDB - INFO - Disconnessione completata
2025-05-19 13:39:50,778 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 15:35:05,198 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 15:35:05,344 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 15:35:13,784 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 15:35:14,038 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 15:35:14,068 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 78d367da...
2025-05-19 15:35:16,183 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 15:35:25,183 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 78d367da...
2025-05-19 15:35:26,534 - CatastoDB - INFO - Disconnessione completata
2025-05-19 15:35:26,539 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 16:29:09,020 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 16:29:09,177 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 16:29:18,788 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 16:29:19,094 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 16:29:19,240 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7a50d7b7...
2025-05-19 16:32:39,818 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 16:32:39,961 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 16:32:50,668 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 16:32:50,931 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 16:32:50,946 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e2a7ada3...
2025-05-19 17:28:33,130 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:28:33,295 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:28:40,298 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:28:40,568 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:28:40,606 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 42e81eb4...
2025-05-19 17:30:58,685 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:30:58,844 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:31:04,934 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:31:05,195 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:31:05,211 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione afeab1e2...
2025-05-19 17:34:25,291 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:34:25,429 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:34:31,488 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:34:31,747 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:34:31,764 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b562e55b...
2025-05-19 17:48:06,545 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:48:06,700 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:48:15,707 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:48:15,967 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:48:15,980 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2a6d8407...
2025-05-19 17:50:53,135 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:50:53,253 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:50:58,461 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:50:58,721 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:50:58,734 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 09cad0e9...
2025-05-19 17:52:41,075 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:52:41,182 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:52:45,858 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:52:46,122 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:52:46,133 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 0f1b93e7...
2025-05-19 17:52:47,946 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 17:53:23,008 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 0f1b93e7...
2025-05-19 17:53:24,357 - CatastoDB - INFO - Disconnessione completata
2025-05-19 17:53:24,363 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 17:54:08,583 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 17:54:08,688 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 17:54:20,468 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 17:54:20,728 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 17:54:20,740 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f9aed6ce...
2025-05-19 17:54:22,037 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 17:55:57,147 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.2) ha prodotto 100 risultati.
2025-05-19 18:07:44,073 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione f9aed6ce...
2025-05-19 18:07:45,359 - CatastoDB - INFO - Disconnessione completata
2025-05-19 18:07:45,365 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 18:07:54,422 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 18:07:54,552 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 18:08:00,094 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 18:08:00,366 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 18:08:00,402 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2d8070f2...
2025-05-19 18:08:01,530 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 18:08:12,680 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 2d8070f2...
2025-05-19 18:08:14,016 - CatastoDB - INFO - Disconnessione completata
2025-05-19 18:08:14,023 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 18:08:25,167 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 18:08:25,327 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 18:08:30,433 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 18:08:30,693 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 18:08:30,707 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5d652faa...
2025-05-19 18:08:32,630 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 18:09:13,994 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 5d652faa...
2025-05-19 18:09:15,171 - CatastoDB - INFO - Disconnessione completata
2025-05-19 18:09:15,181 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-19 18:09:22,804 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-19 18:09:22,911 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-19 18:09:27,966 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-19 18:09:28,219 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-19 18:09:28,230 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 350ec7b1...
2025-05-19 18:09:30,141 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-19 18:09:41,608 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 350ec7b1...
2025-05-19 18:09:42,857 - CatastoDB - INFO - Disconnessione completata
2025-05-19 18:09:42,863 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-20 11:54:21,301 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 11:54:21,390 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 11:54:26,176 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 11:54:26,674 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f412c154...
2025-05-20 11:54:32,802 - CatastoDB - INFO - Disconnessione completata
2025-05-20 11:55:15,750 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 11:55:15,827 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 11:56:08,422 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 11:56:08,713 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-20 11:56:08,762 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione fbe841a4...
2025-05-20 11:56:10,744 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-20 11:56:31,699 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione fbe841a4...
2025-05-20 11:56:33,028 - CatastoDB - INFO - Disconnessione completata
2025-05-20 11:56:33,029 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-20 12:00:10,034 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 12:00:10,117 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 12:00:16,092 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 12:00:16,382 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-20 12:00:16,434 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7c183b08...
2025-05-20 12:00:17,388 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-20 12:02:11,849 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 7c183b08...
2025-05-20 12:02:12,965 - CatastoDB - INFO - Disconnessione completata
2025-05-20 12:02:12,965 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-20 12:02:20,795 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 12:02:20,986 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 12:02:27,285 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 12:02:27,570 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-20 12:02:27,581 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 572bd24b...
2025-05-20 12:02:29,637 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-20 12:02:43,149 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 572bd24b...
2025-05-20 12:02:44,392 - CatastoDB - INFO - Disconnessione completata
2025-05-20 12:02:44,392 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-20 12:14:42,875 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 12:14:42,985 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 12:14:49,945 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 12:14:50,238 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-20 12:14:50,281 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 34c206d0...
2025-05-20 12:14:52,163 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-20 12:15:25,565 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 34c206d0...
2025-05-20 12:15:27,111 - CatastoDB - INFO - Disconnessione completata
2025-05-20 12:15:27,112 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-20 12:15:53,601 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 12:15:53,670 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 12:16:01,987 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 12:16:02,290 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-20 12:16:02,301 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c7f938c3...
2025-05-20 12:16:03,983 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-20 12:16:23,120 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: 'pippo' (soglia: 0.3).
2025-05-20 12:16:25,530 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione c7f938c3...
2025-05-20 12:16:26,753 - CatastoDB - INFO - Disconnessione completata
2025-05-20 12:16:26,754 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-20 12:18:40,465 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-20 12:18:40,569 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-20 12:18:47,347 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-20 12:18:47,641 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-20 12:18:47,688 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione aca2eb05...
2025-05-20 12:18:49,495 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-20 12:20:43,847 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione aca2eb05...
2025-05-20 12:20:44,866 - CatastoDB - INFO - Disconnessione completata
2025-05-20 12:20:44,866 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 08:14:48,596 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 08:14:48,878 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 08:14:59,560 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 08:14:59,877 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 08:14:59,923 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7b287052...
2025-05-21 08:15:02,357 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 08:15:25,778 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 7b287052...
2025-05-21 08:15:26,939 - CatastoDB - INFO - Disconnessione completata
2025-05-21 08:15:26,939 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 08:19:01,831 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 08:19:01,944 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 08:19:08,833 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 08:19:09,839 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1d8aef86...
2025-05-21 08:19:29,001 - __main__ - ERROR - Errore non gestito nel programma: name 'aggiungi_comune' is not defined
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\main.py", line 1733, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\main.py", line 1688, in menu_principale
    elif scelta == "2": menu_inserimento(db)
                        ~~~~~~~~~~~~~~~~^^^^
  File "C:\Users\saint\catasto\gemini\main.py", line 929, in menu_inserimento
    if scelta == "1": aggiungi_comune(db)
                      ^^^^^^^^^^^^^^^
NameError: name 'aggiungi_comune' is not defined
2025-05-21 08:19:29,058 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 1d8aef86...
2025-05-21 08:19:29,060 - CatastoDB - INFO - Disconnessione completata
2025-05-21 08:48:39,755 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 08:48:39,881 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 08:48:51,909 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 08:48:52,857 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 54ef6593...
2025-05-21 08:49:11,082 - CatastoDB - ERROR - Errore Python generico in registra_comune_nel_db per 'Altare': 'CatastoDBManager' object has no attribute 'cursor'
2025-05-21 08:49:11,084 - CatastoDB - INFO - Rollback eseguito.
2025-05-21 08:55:28,899 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 54ef6593...
2025-05-21 08:55:28,902 - CatastoDB - INFO - Disconnessione completata
2025-05-21 08:55:32,002 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 08:55:32,091 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 08:55:38,879 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 08:55:39,743 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a27ad5a6...
2025-05-21 08:55:52,735 - CatastoDB - INFO - Comune 'Altare' (ID: 8) inserito con successo nel database.
2025-05-21 08:56:18,596 - CatastoDB - INFO - Comune 'Altare (Fabbricati)' (ID: 9) inserito con successo nel database.
2025-05-21 08:56:41,060 - CatastoDB - INFO - Comune 'Altare (Terreni)' (ID: 10) inserito con successo nel database.
2025-05-21 08:56:52,083 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:09,869 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:20,026 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:35,050 - CatastoDB - INFO - Disconnessione completata
2025-05-21 08:57:39,432 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 08:57:39,542 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 08:57:47,649 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 08:57:47,976 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 08:57:48,024 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b832523c...
2025-05-21 08:57:50,716 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:51,064 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:51,071 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:51,106 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:57:51,107 - CatastoDB - INFO - Recuperati 0 utenti.
2025-05-21 08:57:58,284 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:58:12,813 - CatastoDB - WARNING - Nessun risultato da recuperare per l'ultima query.
2025-05-21 08:58:18,252 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione b832523c...
2025-05-21 08:58:19,566 - CatastoDB - INFO - Disconnessione completata
2025-05-21 08:58:19,566 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 09:06:20,624 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 09:06:20,738 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 09:06:25,749 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 09:06:26,687 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6398cb48...
2025-05-21 09:06:57,443 - CatastoDB - INFO - Disconnessione completata
2025-05-21 09:07:01,650 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 09:07:01,741 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 09:07:11,986 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 09:07:12,294 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 09:07:12,333 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9af39879...
2025-05-21 09:07:14,948 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 09:09:39,111 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 09:09:39,210 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 09:09:45,562 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 09:09:45,931 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 09:09:46,026 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 21469b22...
2025-05-21 09:09:47,331 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 09:10:19,049 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 09:10:19,131 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 09:10:24,149 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 09:10:24,486 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 09:10:24,493 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 32ba35a8...
2025-05-21 09:10:25,671 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 09:14:45,492 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 09:14:45,610 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 09:14:52,450 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 09:14:52,843 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 09:14:52,890 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ecfee40e...
2025-05-21 09:14:54,485 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 09:34:14,608 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 09:34:14,733 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 09:34:20,598 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 09:34:20,965 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 09:34:21,038 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6fae6bf2...
2025-05-21 09:34:23,184 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 09:35:33,051 - CatastoDB - INFO - Localit‡ 'Via dei Fatti Miei' (Comune ID: 2) inserita con ID: 101
2025-05-21 09:35:56,185 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 2, Partita N.1
2025-05-21 09:41:01,486 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 6fae6bf2...
2025-05-21 09:41:02,736 - CatastoDB - INFO - Disconnessione completata
2025-05-21 09:41:02,736 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 12:18:37,718 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 12:18:37,783 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 12:18:44,082 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 12:18:44,364 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 12:18:44,403 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione dd8c7094...
2025-05-21 12:18:46,124 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 12:19:00,582 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione dd8c7094...
2025-05-21 12:19:01,903 - CatastoDB - INFO - Disconnessione completata
2025-05-21 12:19:01,904 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 12:30:07,070 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 12:30:07,149 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 12:30:12,883 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 12:30:13,172 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 12:30:13,227 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c17d0d1f...
2025-05-21 12:30:14,246 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 12:30:31,537 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione c17d0d1f...
2025-05-21 12:30:32,781 - CatastoDB - INFO - Disconnessione completata
2025-05-21 12:30:32,782 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 12:39:56,341 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 12:39:56,416 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 12:40:02,422 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 12:40:02,705 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 12:40:02,747 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2766e571...
2025-05-21 12:40:03,632 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
             SELECT 
                 id, 
                 nome AS nome_comune, 
                 ... Errore: ERRORE:  la colonna "codice_catastale" non esiste
LINE 5:                  codice_catastale,  -- Assumendo che queste ...
                         ^

2025-05-21 12:40:03,633 - CatastoDB - INFO - Rollback eseguito.
2025-05-21 12:40:03,633 - CatastoGUI - INFO - Nessun comune trovato nel database.
2025-05-21 12:40:03,873 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 12:40:31,303 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 2766e571...
2025-05-21 12:40:32,436 - CatastoDB - INFO - Disconnessione completata
2025-05-21 12:40:32,436 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 12:42:24,659 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 12:42:24,729 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 12:42:29,883 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 12:42:30,182 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 12:42:30,208 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3e85e30b...
2025-05-21 12:42:32,163 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 12:42:35,809 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3e85e30b...
2025-05-21 12:42:37,117 - CatastoDB - INFO - Disconnessione completata
2025-05-21 12:42:37,117 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-21 12:44:05,966 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-21 12:44:06,026 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-21 12:44:10,505 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-21 12:44:10,779 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-21 12:44:10,795 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a864c613...
2025-05-21 12:44:12,617 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-21 12:44:19,211 - CatastoGUI - INFO - Esecuzione logout di sicurezza per utente ID: 1 prima della chiusura...
2025-05-21 12:44:19,228 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione a864c613...
2025-05-21 12:44:19,230 - CatastoDB - INFO - Disconnessione completata
2025-05-21 12:44:19,231 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:25:51,436 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:25:51,585 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:26:02,705 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:26:03,014 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:26:03,059 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 45d0f782...
2025-05-22 18:26:06,290 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:26:30,346 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 45d0f782...
2025-05-22 18:26:32,953 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:26:32,953 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:30:38,402 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:30:38,506 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:30:45,395 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:30:45,740 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:30:45,800 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 25469dd9...
2025-05-22 18:30:47,883 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:31:00,640 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 25469dd9...
2025-05-22 18:31:02,888 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:31:02,889 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:36:49,494 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:36:49,601 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:36:55,662 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:36:56,007 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:36:56,048 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9311525d...
2025-05-22 18:36:57,830 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:37:44,042 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-22 18:38:54,900 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 9311525d...
2025-05-22 18:38:56,898 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:38:56,899 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:39:05,469 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:39:05,594 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:39:12,164 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:39:12,498 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:39:12,550 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3b5dd8f4...
2025-05-22 18:39:14,352 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:39:46,179 - CatastoDB - INFO - Nessun risultato per ricerca avanzata possessori: 'asa' (soglia: 0.3).
2025-05-22 18:39:55,755 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-22 18:40:13,971 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3b5dd8f4...
2025-05-22 18:40:16,020 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:40:16,020 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:41:23,419 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:41:23,507 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:41:31,024 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:41:31,361 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:41:31,397 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione bac69bfc...
2025-05-22 18:41:33,481 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:41:53,036 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione bac69bfc...
2025-05-22 18:41:54,898 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:41:54,898 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:53:08,540 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:53:08,805 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:53:15,500 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:53:15,860 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:53:15,908 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione cae38a74...
2025-05-22 18:53:17,957 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:53:33,077 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione cae38a74...
2025-05-22 18:53:34,678 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:53:34,681 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-22 18:55:21,616 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-22 18:55:21,730 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-22 18:55:28,618 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-22 18:55:28,941 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-22 18:55:28,988 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ca195b2c...
2025-05-22 18:55:30,911 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-22 18:56:43,378 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione ca195b2c...
2025-05-22 18:56:45,246 - CatastoDB - INFO - Disconnessione completata
2025-05-22 18:56:45,246 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 09:01:19,464 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 09:01:19,638 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 09:01:28,894 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 09:01:29,228 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 09:01:29,284 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 54061e04...
2025-05-23 09:01:31,137 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 09:02:03,538 - CatastoGUI - INFO - Nessuna partita trovata per il comune ID: 9
2025-05-23 09:24:13,923 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 54061e04...
2025-05-23 09:24:15,321 - CatastoDB - INFO - Disconnessione completata
2025-05-23 09:24:15,322 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 09:34:04,453 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 09:34:04,574 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 09:34:12,086 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 09:34:12,397 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 09:34:12,497 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f2bc916d...
2025-05-23 09:34:14,522 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 09:37:41,163 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione f2bc916d...
2025-05-23 09:37:42,269 - CatastoDB - INFO - Disconnessione completata
2025-05-23 09:37:42,269 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 09:38:43,071 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 09:38:43,143 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 09:38:49,763 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 09:38:50,055 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 09:38:50,066 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 65496ba6...
2025-05-23 09:38:51,840 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 09:39:20,051 - CatastoDB - INFO - Localit‡ 'Borgata CiccioCicci' (Comune ID: 3) inserita con ID: 102
2025-05-23 09:40:38,121 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 65496ba6...
2025-05-23 09:40:39,322 - CatastoDB - INFO - Disconnessione completata
2025-05-23 09:40:39,323 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 09:48:16,019 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 09:48:16,226 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 09:48:23,489 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 09:48:23,902 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5431a4ca...
2025-05-23 09:48:57,076 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LIMIT %s... Errore: ERRORE:  la relazione "v_audit_dettagliato" non esiste
LINE 1: SELECT * FROM v_audit_dettagliato ORDER BY timestamp DESC LI...
                      ^

2025-05-23 09:48:57,077 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 09:49:05,238 - CatastoDB - INFO - Disconnessione completata
2025-05-23 10:12:40,307 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:12:40,402 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 10:12:46,047 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 10:12:46,331 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 10:12:46,365 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 0d13d6aa...
2025-05-23 10:12:48,394 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 10:16:06,472 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 0d13d6aa...
2025-05-23 10:16:07,590 - CatastoDB - INFO - Disconnessione completata
2025-05-23 10:16:07,590 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 10:17:08,866 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:17:08,928 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 10:17:14,074 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 10:17:14,352 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 10:17:14,372 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione cefcb0eb...
2025-05-23 10:17:15,727 - CatastoGUI - WARNING - Classe ElencoComuniWidget non trovata durante setup_tabs.
2025-05-23 10:17:15,728 - CatastoGUI - WARNING - Classe RicercaPartiteWidget non trovata durante setup_tabs.
2025-05-23 10:17:15,728 - CatastoGUI - WARNING - Classe RicercaPossessoriWidget non trovata durante setup_tabs.
2025-05-23 10:17:15,728 - CatastoGUI - ERROR - CLASSE RicercaAvanzataImmobiliWidget NON TROVATA. Impossibile aggiungere il tab.
2025-05-23 10:17:29,603 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione cefcb0eb...
2025-05-23 10:17:31,089 - CatastoDB - INFO - Disconnessione completata
2025-05-23 10:17:31,089 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 10:26:11,789 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:26:11,864 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 10:26:18,120 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 10:26:18,409 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 10:26:18,451 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2600e509...
2025-05-23 10:26:20,368 - CatastoGUI - WARNING - Classe ElencoComuniWidget non trovata durante setup_tabs.
2025-05-23 10:26:20,369 - CatastoGUI - WARNING - Classe RicercaPartiteWidget non trovata durante setup_tabs.
2025-05-23 10:26:20,369 - CatastoGUI - WARNING - Classe RicercaPossessoriWidget non trovata durante setup_tabs.
2025-05-23 10:26:20,369 - CatastoGUI - ERROR - CLASSE RicercaAvanzataImmobiliWidget NON TROVATA. Impossibile aggiungere il tab.
2025-05-23 10:27:22,562 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 2600e509...
2025-05-23 10:27:23,827 - CatastoDB - INFO - Disconnessione completata
2025-05-23 10:27:23,827 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 10:43:02,945 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:43:03,009 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 10:43:08,312 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 10:43:08,591 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 10:43:08,600 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e5f4b523...
2025-05-23 10:43:10,362 - CatastoGUI - WARNING - Classe ElencoComuniWidget non trovata durante setup_tabs.
2025-05-23 10:43:10,362 - CatastoGUI - WARNING - Classe RicercaPartiteWidget non trovata durante setup_tabs.
2025-05-23 10:43:10,363 - CatastoGUI - WARNING - Classe RicercaPossessoriWidget non trovata durante setup_tabs.
2025-05-23 10:43:10,363 - CatastoGUI - ERROR - CLASSE RicercaAvanzataImmobiliWidget NON TROVATA. Impossibile aggiungere il tab.
2025-05-23 10:43:12,161 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione e5f4b523...
2025-05-23 10:43:13,479 - CatastoDB - INFO - Disconnessione completata
2025-05-23 10:43:13,479 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 10:52:34,921 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:52:35,109 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 10:52:41,260 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 10:52:41,542 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 10:52:41,550 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 8d0fb4f0...
2025-05-23 10:52:42,972 - CatastoGUI - WARNING - Classe ElencoComuniWidget non trovata durante setup_tabs.
2025-05-23 10:52:42,972 - CatastoGUI - WARNING - Classe RicercaPartiteWidget non trovata durante setup_tabs.
2025-05-23 10:52:42,973 - CatastoGUI - WARNING - Classe RicercaPossessoriWidget non trovata durante setup_tabs.
2025-05-23 10:52:42,973 - CatastoGUI - ERROR - CLASSE RicercaAvanzataImmobiliWidget NON TROVATA. Impossibile aggiungere il tab.
2025-05-23 10:52:57,467 - CatastoGUI - INFO - Esecuzione logout di sicurezza per utente ID: 1 prima della chiusura...
2025-05-23 10:52:57,485 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 8d0fb4f0...
2025-05-23 10:52:57,487 - CatastoDB - INFO - Disconnessione completata
2025-05-23 10:52:57,488 - CatastoGUI - INFO - Applicazione GUI terminata.
2025-05-23 10:56:31,068 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:56:31,130 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 10:56:36,184 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 10:56:36,460 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 10:56:36,478 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 58515096...
2025-05-23 10:56:38,113 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 10:56:38,186 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 11:08:07,736 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 11:08:07,823 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 11:08:14,043 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 11:08:14,365 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 11:08:14,412 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1514706d...
2025-05-23 11:08:15,744 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 11:08:15,846 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 11:55:40,869 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 11:55:40,987 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 11:55:52,186 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 11:55:52,546 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 11:55:52,621 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 438ff93a...
2025-05-23 11:55:54,492 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 11:56:00,756 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 438ff93a...
2025-05-23 11:56:02,837 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 11:56:02,838 - CatastoDB - INFO - Disconnessione completata
2025-05-23 11:56:02,839 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 11:56:02,839 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 15:25:16,049 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:25:16,187 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:25:22,654 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:25:22,912 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:25:22,942 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione aab47188...
2025-05-23 15:25:24,183 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 15:26:05,140 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:26:05,249 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:26:09,671 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:26:09,929 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:26:09,939 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione bd6df6eb...
2025-05-23 15:26:11,795 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 15:26:37,314 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => integer, p_localita_id => integer, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 15:26:37,320 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 15:26:46,520 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => integer, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 15:26:46,527 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 15:26:58,102 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-23 15:27:08,826 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 15:27:08,841 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 15:32:13,247 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione bd6df6eb...
2025-05-23 15:32:14,514 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 15:32:14,520 - CatastoDB - INFO - Disconnessione completata
2025-05-23 15:32:14,526 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 15:32:14,531 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 15:32:50,010 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:32:50,126 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:32:56,012 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:32:56,270 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:32:56,286 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione acb69074...
2025-05-23 15:34:19,280 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:34:19,424 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:34:24,768 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:34:25,045 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:34:25,059 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7be5d611...
2025-05-23 15:37:04,032 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:37:04,270 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:37:09,701 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:37:09,963 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:37:09,975 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 32349f03...
2025-05-23 15:37:11,729 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 15:39:10,155 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:39:10,266 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:39:17,437 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:39:17,694 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:39:17,703 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 047a9225...
2025-05-23 15:39:19,563 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 15:43:12,718 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:43:12,825 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:43:17,574 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:43:17,844 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:43:17,853 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2e0e1550...
2025-05-23 15:43:19,729 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 15:43:26,134 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 15:43:26,140 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 15:43:31,975 - CatastoGUI - INFO - Dialogo inserimento comune annullato da utente 'admin'.
2025-05-23 15:50:57,048 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 2e0e1550...
2025-05-23 15:50:58,271 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 15:50:58,280 - CatastoDB - INFO - Disconnessione completata
2025-05-23 15:50:58,286 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 15:50:58,291 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 15:58:58,606 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 15:58:58,747 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 15:59:04,529 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 15:59:04,811 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 15:59:04,827 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b09974eb...
2025-05-23 16:02:59,353 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:02:59,504 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:03:05,353 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:03:05,608 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:03:05,623 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 92ce73d3...
2025-05-23 16:03:07,723 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:04:08,431 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:04:08,552 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:04:13,219 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:04:13,475 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:04:13,485 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 441dcd61...
2025-05-23 16:04:15,039 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:12:46,255 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:12:46,397 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:12:53,973 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:12:54,230 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:12:54,244 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 81ad592b...
2025-05-23 16:12:55,116 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:14:16,833 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 3, Partita N.1
2025-05-23 16:14:57,509 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 16:14:57,515 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 16:15:15,973 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => integer, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 16:15:15,979 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 16:16:34,424 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 81ad592b...
2025-05-23 16:18:34,919 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:18:35,028 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:18:39,594 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:18:39,853 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:18:39,862 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 6e5d0865...
2025-05-23 16:18:40,840 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:25:37,372 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:25:37,480 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:25:46,952 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:25:47,245 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:25:47,255 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c305ee1f...
2025-05-23 16:25:48,762 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:25:59,639 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 16:25:59,646 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 16:26:24,769 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione c305ee1f...
2025-05-23 16:26:26,096 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 16:26:26,105 - CatastoDB - INFO - Disconnessione completata
2025-05-23 16:26:26,115 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 16:26:26,120 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 16:34:19,139 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:34:19,270 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:34:24,799 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:34:25,061 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:34:25,075 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 49482f0b...
2025-05-23 16:34:26,583 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:35:15,266 - CatastoGUI - INFO - Dialogo inserimento comune annullato da utente 'admin'.
2025-05-23 16:37:22,424 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 49482f0b...
2025-05-23 16:37:23,564 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 16:37:23,571 - CatastoDB - INFO - Disconnessione completata
2025-05-23 16:37:23,577 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 16:37:23,588 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 16:38:33,739 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 16:38:33,851 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 16:38:40,735 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 16:38:40,992 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 16:38:41,006 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3715019e...
2025-05-23 16:38:42,258 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 16:39:19,578 - CatastoGUI - INFO - Dialogo inserimento comune annullato da utente 'admin'.
2025-05-23 16:39:23,311 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 16:39:23,317 - CatastoGUI - INFO - Chiusura applicazione: esecuzione logout di sicurezza per utente ID: 1...
2025-05-23 16:39:23,326 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3715019e...
2025-05-23 16:39:23,334 - CatastoDB - INFO - Disconnessione completata
2025-05-23 16:39:23,339 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 16:39:23,345 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 17:13:52,228 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:13:52,350 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:14:13,458 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 17:14:13,740 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 17:14:13,750 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 059c4f9a...
2025-05-23 17:14:15,372 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 17:14:23,147 - CatastoGUI - INFO - Dialogo inserimento comune annullato da utente 'admin'.
2025-05-23 17:14:27,218 - CatastoGUI - INFO - Dialogo inserimento comune annullato da utente 'admin'.
2025-05-23 17:14:37,058 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 17:14:37,065 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 17:16:39,658 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 059c4f9a...
2025-05-23 17:16:41,072 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 17:16:41,079 - CatastoDB - INFO - Disconnessione completata
2025-05-23 17:16:41,085 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 17:16:41,090 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 17:22:32,287 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:22:32,423 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:29:15,636 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:29:15,789 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:31:14,488 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:31:14,622 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:31:22,053 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 17:31:22,349 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 17:31:22,366 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b1bae7da...
2025-05-23 17:31:24,301 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 17:41:56,418 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:41:56,555 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:42:02,389 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 17:42:02,646 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 17:42:02,658 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 98226303...
2025-05-23 17:42:04,007 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-23 17:44:02,941 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:44:03,084 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:44:08,503 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 17:44:08,767 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 17:44:08,780 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione d4202c47...
2025-05-23 17:44:10,523 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-23 17:44:10,719 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 17:44:10,772 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-23 17:44:10,944 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 17:44:10,956 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-23 17:44:10,964 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-23 17:44:10,970 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-23 17:44:10,976 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-23 17:44:10,982 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-23 17:44:18,892 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-23 17:44:18,898 - CatastoDB - INFO - Rollback eseguito.
2025-05-23 17:44:21,434 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione d4202c47...
2025-05-23 17:44:22,638 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 17:44:22,652 - CatastoDB - INFO - Disconnessione completata
2025-05-23 17:44:22,665 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 17:44:22,678 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 17:44:22,703 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-23 17:46:06,717 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 17:46:06,823 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 17:46:11,601 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 17:46:11,851 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 17:46:11,864 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 4f6799de...
2025-05-23 17:46:14,085 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-23 17:46:14,276 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 17:46:14,325 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-23 17:46:14,506 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 17:46:14,518 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-23 17:46:14,524 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-23 17:46:14,529 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-23 17:46:14,535 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-23 17:46:14,557 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-23 17:48:38,604 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 4f6799de...
2025-05-23 17:48:39,998 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 17:48:40,006 - CatastoDB - INFO - Disconnessione completata
2025-05-23 17:48:40,012 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 17:48:40,029 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 17:48:40,049 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-23 18:11:56,979 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 18:11:57,127 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 18:12:04,783 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 18:12:05,041 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 18:12:05,053 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e095c921...
2025-05-23 18:13:37,119 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 18:13:37,235 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 18:13:53,807 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 18:13:54,064 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 18:13:54,075 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2903abc8...
2025-05-23 18:13:55,805 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-23 18:13:56,010 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 18:13:56,064 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-23 18:13:56,253 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 18:13:56,266 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-23 18:13:56,272 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-23 18:13:56,277 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-23 18:13:56,283 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-23 18:13:56,292 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-23 18:14:07,000 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 2903abc8...
2025-05-23 18:14:08,489 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 18:14:08,495 - CatastoDB - INFO - Disconnessione completata
2025-05-23 18:14:08,506 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 18:14:08,516 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 18:14:08,540 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-23 18:58:19,993 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 18:58:20,199 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 18:58:29,779 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 18:58:30,100 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 18:58:30,162 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3a34bcaa...
2025-05-23 18:58:31,548 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-23 18:58:32,257 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 18:58:32,365 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-23 18:58:32,830 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 18:58:32,842 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-23 18:58:32,843 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-23 18:58:32,844 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-23 18:58:32,844 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-23 18:58:32,844 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-23 18:58:45,901 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 18:58:45,902 - CatastoGUI - INFO - Chiusura applicazione: esecuzione logout di sicurezza per utente ID: 1...
2025-05-23 18:58:45,928 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3a34bcaa...
2025-05-23 18:58:45,931 - CatastoDB - INFO - Disconnessione completata
2025-05-23 18:58:45,931 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 18:58:45,932 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 18:58:45,955 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-23 18:58:52,301 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 18:58:52,395 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-23 18:58:59,179 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-23 18:58:59,542 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-23 18:58:59,552 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e6bdbcf2...
2025-05-23 18:59:01,150 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-23 18:59:01,711 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 18:59:01,816 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-23 18:59:02,112 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-23 18:59:02,120 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-23 18:59:02,120 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-23 18:59:02,121 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-23 18:59:02,121 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-23 18:59:02,121 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-23 18:59:38,130 - CatastoGUI - INFO - Dialogo inserimento comune annullato da utente 'admin'.
2025-05-23 18:59:44,554 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione e6bdbcf2...
2025-05-23 18:59:46,683 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-23 18:59:46,685 - CatastoDB - INFO - Disconnessione completata
2025-05-23 18:59:46,685 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-23 18:59:46,685 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-23 18:59:46,700 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-23 19:11:28,886 - CatastoDB - INFO - Inizializzato gestore per database catasto_storico (schema: catasto)
2025-05-23 19:22:12,998 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-23 19:24:45,657 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 07:47:56,368 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 07:47:56,549 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 07:47:56,634 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 07:48:05,105 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 07:48:05,403 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 07:48:05,472 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione aa206c37...
2025-05-24 07:48:07,859 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 07:48:08,600 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 07:48:08,703 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 07:48:09,105 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 07:48:09,109 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 07:48:09,110 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 07:48:09,110 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 07:48:09,110 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 07:48:09,111 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 07:48:15,042 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 07:48:15,043 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 07:55:02,605 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione aa206c37...
2025-05-24 07:55:05,493 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 07:55:05,500 - CatastoDB - INFO - Disconnessione completata
2025-05-24 07:55:05,500 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 07:55:05,501 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 07:55:05,526 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 07:55:20,928 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 07:55:21,239 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 07:55:21,306 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 07:55:30,131 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 07:55:30,473 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 07:55:30,517 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e01f4765...
2025-05-24 07:55:32,220 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 07:55:32,990 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 07:55:33,087 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 07:55:33,391 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 07:55:33,398 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 07:55:33,399 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 07:55:33,399 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 07:55:33,399 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 07:55:33,399 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 07:55:39,816 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => unknown, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 07:55:39,817 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 07:56:40,202 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: 
            SELECT * FROM catasto.cerca_immobili_avanzato(
                p_comune_id => %s,
     ... Errore: ERRORE:  la funzione catasto.cerca_immobili_avanzato(p_comune_id => integer, p_localita_id => unknown, p_natura => unknown, p_classificazione => unknown, p_consistenza_search => unknown, p_piani_min => unknown, p_piani_max => unknown, p_vani_min => unknown, p_vani_max => unknown, p_nome_possessore => unknown, p_data_inizio_possesso => unknown, p_data_fine_possesso => unknown) non esiste
LINE 2:             SELECT * FROM catasto.cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 07:56:40,202 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 07:58:47,127 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione e01f4765...
2025-05-24 07:58:49,983 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 07:58:49,986 - CatastoDB - INFO - Disconnessione completata
2025-05-24 07:58:49,987 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 07:58:49,987 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 07:58:50,008 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 08:02:48,042 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 08:02:48,125 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 08:02:48,189 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 08:02:56,235 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 08:02:58,132 - CatastoGUI - WARNING - Login GUI fallito (pwd errata) per ID: 1
2025-05-24 08:03:00,952 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 08:03:01,328 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 08:03:01,382 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2054251a...
2025-05-24 08:03:02,897 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 08:03:03,437 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 08:03:03,531 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 08:03:03,824 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 08:03:03,833 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 08:03:03,833 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 08:03:03,871 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 08:03:03,872 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 08:03:03,872 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 08:03:09,192 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 08:03:09,193 - CatastoDB_catasto_storico_localhost - ERROR - Errore generico durante l'esecuzione di ricerca_avanzata_immobili_gui: 'CatastoDBManager' object has no attribute '_get_connection'
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 1742, in ricerca_avanzata_immobili_gui
    conn_to_use = self._get_connection() # Ottieni connessione dal pool o singola
                  ^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute '_get_connection'
2025-05-24 08:09:04,429 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 2054251a...
2025-05-24 08:09:06,060 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 08:09:06,062 - CatastoDB - INFO - Disconnessione completata
2025-05-24 08:09:06,062 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 08:09:06,062 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 08:09:06,094 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 08:09:14,134 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 08:09:14,231 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 08:09:14,415 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 08:09:20,151 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 08:09:20,477 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 08:09:20,527 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione afc27e4b...
2025-05-24 08:09:21,800 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 08:09:22,347 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 08:09:22,459 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 08:09:22,772 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 08:09:22,779 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 08:09:22,779 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 08:09:22,780 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 08:09:22,780 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 08:09:22,780 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 08:09:26,917 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 08:09:26,918 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 08:09:26,963 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB specifico durante l'esecuzione di ricerca_avanzata_immobili_gui: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.
Traceback (most recent call last):
  File "C:\Users\saint\catasto\gemini\catasto_db_manager.py", line 1817, in ricerca_avanzata_immobili_gui
    cur.execute(query, params)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\saint\AppData\Local\Programs\Python\Python313\Lib\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 08:09:26,996 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 08:09:32,408 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione afc27e4b...
2025-05-24 08:09:34,802 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 08:09:34,804 - CatastoDB - INFO - Disconnessione completata
2025-05-24 08:09:34,804 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 08:09:34,804 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 08:09:34,827 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 08:40:41,193 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 08:40:41,326 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 08:40:41,431 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 08:40:48,981 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 08:40:49,233 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 08:40:49,270 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f18ac3ea...
2025-05-24 08:40:51,062 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 08:40:51,271 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 08:40:51,316 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 08:40:51,501 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 08:40:51,516 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 08:40:51,522 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 08:40:51,528 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 08:40:51,535 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 08:40:51,541 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 08:40:57,079 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.3) ha prodotto 100 risultati.
2025-05-24 08:48:36,777 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione f18ac3ea...
2025-05-24 08:48:38,267 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 08:48:38,274 - CatastoDB - INFO - Disconnessione completata
2025-05-24 08:48:38,280 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 08:48:38,286 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 08:48:38,303 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 09:54:34,994 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 09:54:35,145 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 09:54:35,353 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 09:54:42,567 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 09:54:42,837 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7386b44b...
2025-05-24 09:54:59,074 - __main__ - ERROR - Errore non gestito nel programma: 'CatastoDBManager' object has no attribute 'ricerca_avanzata_immobili'
Traceback (most recent call last):
  File "U:\catasto\gemini\main.py", line 1756, in main
    menu_principale(db) # Entra nel menu principale dopo login riuscito
    ~~~~~~~~~~~~~~~^^^^
  File "U:\catasto\gemini\main.py", line 1710, in menu_principale
    if scelta == "1": menu_consultazione(db)
                      ~~~~~~~~~~~~~~~~~~^^^^
  File "U:\catasto\gemini\main.py", line 772, in menu_consultazione
    results_immobili = db.ricerca_avanzata_immobili( # Rinominato
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'ricerca_avanzata_immobili'. Did you mean: 'ricerca_avanzata_immobili_gui'?
2025-05-24 09:54:59,190 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 7386b44b...
2025-05-24 09:54:59,197 - CatastoDB - INFO - Disconnessione completata
2025-05-24 10:12:46,924 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 10:12:47,038 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 10:12:47,145 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 10:12:52,293 - CatastoDB - INFO - Disconnessione completata
2025-05-24 10:12:58,363 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 10:12:58,476 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 10:12:58,692 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 10:13:04,466 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 10:13:04,720 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 10:13:04,730 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 86947bd1...
2025-05-24 10:13:06,474 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 10:13:06,690 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:13:06,742 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 10:13:06,972 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:13:06,987 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 10:13:06,993 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 10:13:06,999 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 10:13:07,006 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 10:13:07,012 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 10:13:15,943 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 10:13:15,954 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:13:15,968 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB specifico durante l'esecuzione di ricerca_avanzata_immobili_gui: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1817, in ricerca_avanzata_immobili_gui
    cur.execute(query, params)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 10:13:16,081 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:13:46,684 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (1, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 10:13:46,694 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:13:46,706 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB specifico durante l'esecuzione di ricerca_avanzata_immobili_gui: ERRORE:  la funzione catasto.cerca_immobili_avanzato(integer, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1817, in ricerca_avanzata_immobili_gui
    cur.execute(query, params)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: ERRORE:  la funzione catasto.cerca_immobili_avanzato(integer, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 10:13:46,746 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:15:52,372 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 86947bd1...
2025-05-24 10:21:54,496 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 10:21:54,611 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 10:21:54,721 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 10:22:01,156 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 10:22:01,405 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 10:22:01,421 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ae7391e8...
2025-05-24 10:22:02,420 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 10:22:02,622 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:22:02,677 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 10:22:02,899 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:22:02,911 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 10:22:02,917 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 10:22:02,923 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 10:22:02,931 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 10:22:02,937 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 10:22:06,768 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 10:22:06,780 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:22:06,793 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB specifico durante l'esecuzione di ricerca_avanzata_immobili_gui: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1817, in ricerca_avanzata_immobili_gui
    cur.execute(query, params)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 10:22:06,884 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:22:11,385 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (3, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 10:22:11,397 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:22:11,410 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB specifico durante l'esecuzione di ricerca_avanzata_immobili_gui: ERRORE:  la funzione catasto.cerca_immobili_avanzato(integer, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1817, in ricerca_avanzata_immobili_gui
    cur.execute(query, params)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: ERRORE:  la funzione catasto.cerca_immobili_avanzato(integer, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 10:22:11,441 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:22:14,151 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione ae7391e8...
2025-05-24 10:22:15,265 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 10:22:15,272 - CatastoDB - INFO - Disconnessione completata
2025-05-24 10:22:15,278 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 10:22:15,283 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 10:22:15,300 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 10:22:47,139 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 10:22:47,367 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 10:22:47,474 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 10:22:52,229 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 10:22:52,479 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 10:22:52,488 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione da1171b8...
2025-05-24 10:22:54,383 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 10:22:54,581 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:22:54,634 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 10:22:54,841 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:22:54,856 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 10:22:54,863 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 10:22:54,868 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 10:22:54,874 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 10:22:54,881 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 10:22:58,496 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.cerca_immobili_avanzato con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 10:22:58,509 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:22:58,523 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB specifico durante l'esecuzione di ricerca_avanzata_immobili_gui: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1817, in ricerca_avanzata_immobili_gui
    cur.execute(query, params)
    ~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\extras.py", line 236, in execute
    return super().execute(query, vars)
           ~~~~~~~~~~~~~~~^^^^^^^^^^^^^
psycopg2.errors.UndefinedFunction: ERRORE:  la funzione catasto.cerca_immobili_avanzato(unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown, unknown) non esiste
LINE 2:             SELECT * FROM "catasto".cerca_immobili_avanzato(
                                  ^
HINT:  Nessuna funzione trovata con nome e tipi di argomenti forniti. Potrebbe essere necessario convertire i tipi esplicitamente.

2025-05-24 10:22:58,621 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 10:23:02,207 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione da1171b8...
2025-05-24 10:23:03,333 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 10:23:03,341 - CatastoDB - INFO - Disconnessione completata
2025-05-24 10:23:03,347 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 10:23:03,352 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 10:23:03,369 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 10:32:15,005 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 10:32:15,152 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 10:32:15,261 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 10:32:20,669 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 10:32:20,929 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 10:32:20,945 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 46643bc6...
2025-05-24 10:32:21,808 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 10:32:22,004 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:32:22,060 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 10:32:22,260 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:32:22,282 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 10:32:22,288 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 10:32:22,295 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 10:32:22,301 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 10:32:22,308 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 10:32:26,031 - CatastoDB_catasto_storico_localhost - ERROR - Errore generico durante ricerca_avanzata_immobili_gui: 'CatastoDBManager' object has no attribute 'get_connection'
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1773, in ricerca_avanzata_immobili_gui
    with self.get_connection() as conn:
         ^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'get_connection'. Did you mean: '_get_connection'?
2025-05-24 10:32:32,470 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 46643bc6...
2025-05-24 10:32:33,730 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 10:32:33,737 - CatastoDB - INFO - Disconnessione completata
2025-05-24 10:32:33,743 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 10:32:33,748 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 10:32:33,767 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 10:33:36,367 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 10:33:36,569 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 10:33:36,683 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 10:59:37,590 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 10:59:37,856 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 10:59:37,872 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a819eb26...
2025-05-24 10:59:39,455 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 10:59:39,680 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:59:39,735 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 10:59:39,985 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 10:59:39,997 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 10:59:40,003 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 10:59:40,008 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 10:59:40,014 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 10:59:40,020 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 10:59:43,895 - CatastoDB_catasto_storico_localhost - ERROR - Errore generico durante ricerca_avanzata_immobili_gui: 'CatastoDBManager' object has no attribute 'get_connection'
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1773, in ricerca_avanzata_immobili_gui
    with self.get_connection() as conn:
         ^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'get_connection'. Did you mean: '_get_connection'?
2025-05-24 10:59:56,452 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione a819eb26...
2025-05-24 10:59:57,426 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 10:59:57,433 - CatastoDB - INFO - Disconnessione completata
2025-05-24 10:59:57,439 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 10:59:57,450 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 10:59:57,475 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:00:06,412 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:00:06,663 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:00:06,774 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:00:11,993 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:00:12,249 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:00:12,260 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 073bc5e2...
2025-05-24 11:00:12,989 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:00:13,208 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:00:13,252 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:00:13,472 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:00:13,483 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:00:13,489 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:00:13,496 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:00:13,502 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:00:13,507 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:00:17,319 - CatastoDB_catasto_storico_localhost - ERROR - Errore generico durante ricerca_avanzata_immobili_gui: 'CatastoDBManager' object has no attribute 'get_connection'
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1773, in ricerca_avanzata_immobili_gui
    with self.get_connection() as conn:
         ^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'get_connection'. Did you mean: '_get_connection'?
2025-05-24 11:32:01,931 - CatastoDB_catasto_storico_localhost - ERROR - Errore generico durante ricerca_avanzata_immobili_gui: 'CatastoDBManager' object has no attribute 'get_connection'
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 1773, in ricerca_avanzata_immobili_gui
    with self.get_connection() as conn:
         ^^^^^^^^^^^^^^^^^^^
AttributeError: 'CatastoDBManager' object has no attribute 'get_connection'. Did you mean: '_get_connection'?
2025-05-24 11:32:57,014 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 073bc5e2...
2025-05-24 11:32:58,047 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:32:58,054 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:32:58,060 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:32:58,067 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:32:58,099 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:33:06,792 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:33:07,011 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:33:07,118 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:33:12,192 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:33:12,447 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:33:12,456 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 58f382c9...
2025-05-24 11:33:13,261 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:33:13,453 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:33:13,498 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:33:13,721 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:33:13,738 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:33:13,745 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:33:13,750 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:33:13,758 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:33:13,763 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:33:17,316 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:33:17,328 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:33:17,499 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 11:33:24,028 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:33:24,039 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (1, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:33:24,085 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 1503 risultati.
2025-05-24 11:33:31,499 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:33:31,511 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (1, 13, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:33:31,531 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 91 risultati.
2025-05-24 11:33:42,992 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:33:43,004 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (1, 13, 'casa', None, None, None, None, None, None, None, None, None)
2025-05-24 11:33:43,022 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 0 risultati.
2025-05-24 11:33:49,331 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:33:49,344 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (1, 13, 'Casa', None, None, None, None, None, None, None, None, None)
2025-05-24 11:33:49,363 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 0 risultati.
2025-05-24 11:33:55,165 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 11:33:55,210 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 11:33:55,223 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 11:33:55,234 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (1, None, 'Casa', None, None, None, None, None, None, None, None, None)
2025-05-24 11:33:55,262 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 1 risultati.
2025-05-24 11:34:17,069 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 11:34:17,108 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 11:34:17,120 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 11:34:17,132 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (1, None, 'Casa', None, None, None, None, None, None, 'Rossi', None, None)
2025-05-24 11:34:17,170 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 1 risultati.
2025-05-24 11:34:25,085 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 11:34:25,119 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 11:34:25,132 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 11:34:25,143 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (5, None, 'Casa', None, None, None, None, None, None, 'Rossi', None, None)
2025-05-24 11:34:25,167 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 0 risultati.
2025-05-24 11:34:33,557 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 11:34:33,600 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 11:34:33,611 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 11:34:33,622 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (5, None, 'Casa', None, None, None, None, None, None, None, None, None)
2025-05-24 11:34:33,648 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 0 risultati.
2025-05-24 11:34:40,253 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 11:34:40,288 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 11:34:40,300 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 11:34:40,312 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (5, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:34:40,357 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 1500 risultati.
2025-05-24 11:34:55,774 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 11:34:55,813 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 11:34:55,826 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 11:34:55,838 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (5, None, None, None, None, None, None, None, None, 'Rossi', None, None)
2025-05-24 11:34:55,915 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 1500 risultati.
2025-05-24 11:35:07,411 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 58f382c9...
2025-05-24 11:35:08,640 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:35:08,648 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:35:08,654 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:35:08,660 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:35:08,681 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:36:18,714 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:36:18,833 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:36:18,942 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:36:59,308 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:36:59,569 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:36:59,579 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5a3154fc...
2025-05-24 11:37:23,386 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:37:23,652 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:37:23,706 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:37:23,991 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:37:24,002 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:37:24,008 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:37:24,013 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:37:24,018 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:37:24,025 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:37:27,737 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:37:27,760 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:37:28,031 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 11:43:17,191 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 5a3154fc...
2025-05-24 11:43:18,406 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:43:18,414 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:43:18,421 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:43:18,427 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:43:18,456 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:43:26,999 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:43:27,144 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:43:27,253 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:43:35,106 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:43:35,367 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:43:35,381 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 203ce85b...
2025-05-24 11:43:37,569 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:43:37,909 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:43:37,964 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:43:38,313 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:43:38,326 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:43:38,332 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:43:38,338 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:43:38,344 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:43:38,350 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:44:09,128 - CatastoDB - INFO - Avvio aggiornamento viste materializzate...
2025-05-24 11:44:09,320 - CatastoDB - INFO - Aggiornamento viste completato.
2025-05-24 11:44:59,546 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 203ce85b...
2025-05-24 11:45:00,786 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:45:00,793 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:45:00,798 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:45:00,804 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:45:00,819 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:45:10,594 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:45:10,710 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:45:10,816 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:45:17,155 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:45:17,414 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:45:17,426 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 58698ca4...
2025-05-24 11:45:19,358 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:45:19,789 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:45:19,850 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:45:20,106 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:45:20,125 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:45:20,130 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:45:20,137 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:45:20,142 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:45:20,148 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:49:15,726 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 58698ca4...
2025-05-24 11:49:16,810 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:49:16,816 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:49:16,822 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:49:16,829 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:49:16,846 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:49:23,872 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:49:23,991 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:49:24,098 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:49:29,746 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:49:30,004 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:49:30,015 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 411e814e...
2025-05-24 11:49:31,622 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:49:31,959 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:49:32,013 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:49:32,369 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:49:32,380 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:49:32,386 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:49:32,391 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:49:32,397 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:49:32,403 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:49:46,965 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 411e814e...
2025-05-24 11:49:48,034 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:49:48,042 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:49:48,048 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:49:48,057 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:49:48,072 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:52:43,513 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:52:43,670 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:52:43,784 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:52:49,769 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:52:50,029 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:52:50,043 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7eeaed02...
2025-05-24 11:52:51,156 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:52:51,522 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:52:51,576 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:52:51,934 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:52:51,947 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:52:51,953 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:52:51,959 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:52:51,965 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:52:51,971 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:52:58,877 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:52:58,924 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:52:59,139 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 11:53:07,584 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:53:07,597 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:53:07,748 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 11:54:27,181 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:54:27,214 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:54:27,375 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 11:59:01,072 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 7eeaed02...
2025-05-24 11:59:02,091 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:59:02,098 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:59:02,103 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:59:02,108 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:59:02,128 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 11:59:09,119 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 11:59:09,232 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 11:59:09,340 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 11:59:14,567 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 11:59:14,824 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 11:59:14,834 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 4f974926...
2025-05-24 11:59:18,009 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 11:59:18,404 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:59:18,464 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 11:59:18,680 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 11:59:18,690 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 11:59:18,696 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 11:59:18,702 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 11:59:18,708 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 11:59:18,714 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 11:59:26,229 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 11:59:26,241 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 11:59:26,390 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 11:59:54,329 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 4f974926...
2025-05-24 11:59:55,244 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 11:59:55,252 - CatastoDB - INFO - Disconnessione completata
2025-05-24 11:59:55,258 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 11:59:55,263 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 11:59:55,282 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 12:00:06,959 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 12:00:07,108 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 12:00:07,218 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 12:00:13,341 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 12:00:13,602 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 12:00:13,615 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a8b9c209...
2025-05-24 12:00:15,003 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 12:00:15,396 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 12:00:15,457 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 12:00:15,684 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 12:00:15,702 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 12:00:15,708 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 12:00:15,715 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 12:00:15,720 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 12:00:15,728 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 12:00:18,190 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 12:00:18,201 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 12:00:18,465 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7505 risultati.
2025-05-24 12:00:27,549 - CatastoDB - INFO - Ricerca avanzata possessori per 'rossi' (soglia: 0.3) ha prodotto 95 risultati.
2025-05-24 12:06:16,906 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione a8b9c209...
2025-05-24 12:06:18,127 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 12:06:18,144 - CatastoDB - INFO - Disconnessione completata
2025-05-24 12:06:18,171 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 12:06:18,177 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 12:06:18,196 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 13:09:46,896 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 13:09:47,069 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 13:09:47,177 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 13:09:54,240 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 13:09:54,500 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 13:09:54,512 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 8e65077a...
2025-05-24 13:09:54,517 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 13:09:54,533 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=8e65077a...
2025-05-24 13:09:55,656 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 13:09:55,979 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 13:09:56,049 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 13:09:56,270 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 13:09:56,287 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 13:09:56,293 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 13:09:56,298 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 13:09:56,304 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 13:09:56,310 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 13:15:53,472 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 13:15:53,621 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 13:15:53,729 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 13:15:59,330 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 13:15:59,591 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 13:15:59,603 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 0a08655f...
2025-05-24 13:15:59,608 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 13:15:59,621 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=0a08655f...
2025-05-24 13:16:00,516 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 13:16:00,861 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 13:16:01,038 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 13:16:01,249 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 13:16:01,260 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 13:16:01,266 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 13:16:01,272 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 13:16:01,281 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 13:16:01,287 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 13:16:51,660 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 13:16:51,775 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 13:16:51,883 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 13:16:56,236 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 13:16:56,493 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 13:16:56,503 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione f2d6f91b...
2025-05-24 13:16:56,509 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 13:16:56,522 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=f2d6f91b...
2025-05-24 13:16:57,715 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 13:16:58,054 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 13:16:58,119 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 13:16:58,338 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 13:16:58,350 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 13:16:58,355 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 13:16:58,361 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 13:16:58,368 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 13:16:58,374 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 13:17:00,078 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione f2d6f91b...
2025-05-24 13:17:01,265 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 13:17:01,271 - CatastoDB - INFO - Disconnessione completata
2025-05-24 13:17:01,278 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 13:17:01,283 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 13:17:01,305 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 16:07:39,035 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:07:39,286 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:07:39,504 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:07:47,202 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:07:47,464 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:07:47,480 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ca4a8278...
2025-05-24 16:07:47,485 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:07:47,498 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=ca4a8278...
2025-05-24 16:07:48,959 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:07:49,296 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:07:49,358 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:07:49,575 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:07:49,589 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:07:49,595 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:07:49,601 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:07:49,607 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:07:49,613 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:07:52,406 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:07:52,418 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-24 16:07:52,597 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7500 risultati.
2025-05-24 16:09:20,942 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:09:21,057 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:09:21,162 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:09:26,255 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:09:26,506 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:09:26,519 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 0165829d...
2025-05-24 16:09:26,525 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:09:26,538 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=0165829d...
2025-05-24 16:09:27,304 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:09:27,631 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:09:27,694 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:09:27,906 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:09:27,918 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:09:27,924 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:09:27,929 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:09:27,935 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:09:27,943 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:09:30,913 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:09:30,928 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 16:09:30,955 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 0165829d...
2025-05-24 16:09:32,267 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 16:09:32,274 - CatastoDB - INFO - Disconnessione completata
2025-05-24 16:09:32,280 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 16:09:32,285 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 16:09:32,299 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 16:09:42,141 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:09:42,262 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:09:42,377 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:09:48,145 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:09:48,420 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:09:48,430 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b74da74c...
2025-05-24 16:09:48,435 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:09:48,448 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=b74da74c...
2025-05-24 16:09:49,520 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:09:49,836 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:09:49,901 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:09:50,116 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:09:50,126 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:09:50,133 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:09:50,139 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:09:50,145 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:09:50,150 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:10:04,983 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:10:04,995 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 16:10:05,010 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione b74da74c...
2025-05-24 16:10:06,191 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 16:10:06,197 - CatastoDB - INFO - Disconnessione completata
2025-05-24 16:10:06,203 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 16:10:06,208 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 16:10:06,229 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 16:18:32,066 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:18:32,217 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:18:32,333 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:18:37,505 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:18:37,760 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:18:37,774 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3f63eb10...
2025-05-24 16:18:37,780 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:18:37,794 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=3f63eb10...
2025-05-24 16:18:39,203 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:18:39,550 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:21:30,589 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:21:30,698 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:21:30,916 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:21:35,978 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:21:36,237 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:21:36,248 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 4df6c89f...
2025-05-24 16:21:36,253 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:21:36,265 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=4df6c89f...
2025-05-24 16:21:37,132 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:21:37,463 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:21:37,587 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:21:37,599 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:21:37.485000'::timestamp AND timestamp <= '2025-05-24T16:21:37.485000'::timestamp;
2025-05-24 16:21:37,621 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:21:37.485000'::timestamp AND timestamp <= '2025-05-24T16:21:37.485000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:21:37,665 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:21:37,819 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:21:38,071 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:21:38,194 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:21:38,206 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:21:38.094000'::timestamp AND timestamp <= '2025-05-24T16:21:38.094000'::timestamp;
2025-05-24 16:21:38,220 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:21:38.094000'::timestamp AND timestamp <= '2025-05-24T16:21:38.094000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:21:38,243 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:21:38,346 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:21:38,352 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:21:38,358 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:21:38,363 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:21:38,369 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:22:27,103 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:22:27,114 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-01T16:21:38.082000'::timestamp AND timestamp <= '2025-05-24T16:21:38.082000'::timestamp;
2025-05-24 16:22:27,130 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-01T16:21:38.082000'::timestamp AND timestamp <= '2025-05-24T16:21:38.082000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:22:27,155 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:22:50,124 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:22:50,136 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE operazione = 'I' AND timestamp >= '2025-05-01T16:21:38.082000'::timestamp AND timestamp <= '2025-05-24T16:21:38.082000'::timestamp;
2025-05-24 16:22:50,155 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE operazione = 'I' AND timestamp >= '2025-05-01T16:21:38.082000'::timestamp AND timestamp <= '2025-05-24T16:21:38.082000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:22:50,180 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 142). Totale filtrati: 14150
2025-05-24 16:34:51,618 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 147, in _get_connection
    try:
    
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 16:34:51,709 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 16:34:51,722 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 16:34:51,737 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 16:34:51,756 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 4df6c89f...
2025-05-24 16:34:52,954 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 16:34:52,960 - CatastoDB - INFO - Disconnessione completata
2025-05-24 16:34:52,967 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 16:34:52,972 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 16:34:52,987 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 16:34:58,603 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:34:58,720 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:34:58,967 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:35:04,259 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:35:04,514 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:35:04,526 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione fccbce2a...
2025-05-24 16:35:04,532 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:35:04,545 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=fccbce2a...
2025-05-24 16:35:05,433 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:35:05,760 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:35:05,891 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:35:05,903 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:35:05.786000'::timestamp AND timestamp <= '2025-05-24T16:35:05.786000'::timestamp;
2025-05-24 16:35:05,917 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:35:05.786000'::timestamp AND timestamp <= '2025-05-24T16:35:05.786000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:35:05,942 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:35:06,098 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:35:06,355 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:35:06,595 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:35:06,606 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:35:06.376000'::timestamp AND timestamp <= '2025-05-24T16:35:06.376000'::timestamp;
2025-05-24 16:35:06,621 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:35:06.376000'::timestamp AND timestamp <= '2025-05-24T16:35:06.376000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:35:06,646 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:35:06,763 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:35:06,769 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:35:06,774 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:35:06,780 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:35:06,786 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:37:24,795 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:37:24,808 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 16:37:24,825 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione fccbce2a...
2025-05-24 16:37:25,914 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 16:37:25,921 - CatastoDB - INFO - Disconnessione completata
2025-05-24 16:37:25,929 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 16:37:25,935 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 16:37:25,951 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 16:50:01,950 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:50:02,210 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:50:02,346 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:50:07,609 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:50:07,867 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:50:07,887 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c62da4fb...
2025-05-24 16:50:07,892 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:50:07,904 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=c62da4fb...
2025-05-24 16:50:09,032 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:50:09,377 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:50:09,505 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:50:09,518 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:50:09.403000'::timestamp AND timestamp <= '2025-05-24T16:50:09.403000'::timestamp;
2025-05-24 16:50:09,545 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:50:09.403000'::timestamp AND timestamp <= '2025-05-24T16:50:09.403000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:50:09,587 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:50:09,758 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:50:10,015 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:50:10,145 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:50:10,156 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:50:10.033000'::timestamp AND timestamp <= '2025-05-24T16:50:10.033000'::timestamp;
2025-05-24 16:50:10,176 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:50:10.033000'::timestamp AND timestamp <= '2025-05-24T16:50:10.033000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:50:10,208 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:50:10,323 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:50:10,329 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:50:10,334 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:50:10,340 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:50:10,346 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:55:20,552 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 16:55:20,697 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 16:55:20,804 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 16:55:26,860 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 16:55:27,121 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 16:55:27,144 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c9dc7402...
2025-05-24 16:55:27,150 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:55:27,163 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=c9dc7402...
2025-05-24 16:55:28,010 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 16:55:28,349 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:55:28,472 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:55:28,483 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:55:28.370000'::timestamp AND timestamp <= '2025-05-24T16:55:28.370000'::timestamp;
2025-05-24 16:55:28,499 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:55:28.370000'::timestamp AND timestamp <= '2025-05-24T16:55:28.370000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:55:28,536 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:55:28,705 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 16:55:28,965 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 16:55:29,085 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 16:55:29,097 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T16:55:28.980000'::timestamp AND timestamp <= '2025-05-24T16:55:28.980000'::timestamp;
2025-05-24 16:55:29,112 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T16:55:28.980000'::timestamp AND timestamp <= '2025-05-24T16:55:28.980000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 16:55:29,138 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 16:55:29,248 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 16:55:29,254 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 16:55:29,259 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 16:55:29,265 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 16:55:29,271 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 16:55:38,712 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE
2025-05-24 16:55:38,724 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_165534.dump --blobs --verbose catasto_storico
2025-05-24 17:04:48,492 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 17:04:48,606 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 17:04:48,718 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 17:04:54,525 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 17:04:54,779 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 17:04:54,790 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 3abab9ae...
2025-05-24 17:04:54,796 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:04:54,811 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=3abab9ae...
2025-05-24 17:04:55,659 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 17:04:55,978 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 17:04:56,105 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:04:56,117 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T17:04:56'::timestamp AND timestamp <= '2025-05-24T17:04:56'::timestamp;
2025-05-24 17:04:56,133 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T17:04:56'::timestamp AND timestamp <= '2025-05-24T17:04:56'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 17:04:56,166 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 17:04:56,492 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 17:04:56,881 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 17:04:56,999 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:04:57,011 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T17:04:56.900000'::timestamp AND timestamp <= '2025-05-24T17:04:56.900000'::timestamp;
2025-05-24 17:04:57,025 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T17:04:56.900000'::timestamp AND timestamp <= '2025-05-24T17:04:56.900000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 17:04:57,051 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 17:04:57,169 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 17:04:57,175 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 17:04:57,181 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 17:04:57,187 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 17:04:57,193 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 17:05:25,046 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE
2025-05-24 17:05:25,058 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file C:/Users/ipabcrmm/Downloads/catasto_storico_backup_20250524_170503.dump --blobs --verbose catasto_storico
2025-05-24 17:08:57,743 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:08:57,756 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 17:08:57,772 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 3abab9ae...
2025-05-24 17:08:58,980 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 17:08:58,986 - CatastoDB - INFO - Disconnessione completata
2025-05-24 17:08:58,993 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 17:08:58,999 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 17:08:59,015 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 17:35:50,489 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 17:35:50,654 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 17:35:50,760 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 17:35:56,692 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 17:35:56,946 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 17:35:56,967 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7f1bb61f...
2025-05-24 17:35:56,978 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:35:56,991 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=7f1bb61f...
2025-05-24 17:35:58,000 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 17:35:58,339 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 17:35:58,470 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:35:58,482 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T17:35:58.360000'::timestamp AND timestamp <= '2025-05-24T17:35:58.360000'::timestamp;
2025-05-24 17:35:58,507 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T17:35:58.360000'::timestamp AND timestamp <= '2025-05-24T17:35:58.360000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 17:35:58,552 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 17:35:58,889 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 17:35:59,184 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 17:35:59,319 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 17:35:59,330 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T17:35:59.205000'::timestamp AND timestamp <= '2025-05-24T17:35:59.205000'::timestamp;
2025-05-24 17:35:59,345 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T17:35:59.205000'::timestamp AND timestamp <= '2025-05-24T17:35:59.205000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 17:35:59,369 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 17:35:59,502 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 17:35:59,507 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 17:35:59,512 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 17:35:59,517 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 17:35:59,523 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 17:36:14,008 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 17:36:14,022 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 17:36:14,034 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: .\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_173605.dump catasto_storico
2025-05-24 18:53:18,521 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 18:53:18,639 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 18:53:18,748 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 18:53:25,718 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 18:53:25,977 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 18:53:25,990 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione ac093f0b...
2025-05-24 18:53:25,996 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 18:53:26,009 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=ac093f0b...
2025-05-24 18:53:28,392 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 18:53:28,750 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 18:53:28,885 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 18:53:28,896 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T18:53:28.776000'::timestamp AND timestamp <= '2025-05-24T18:53:28.776000'::timestamp;
2025-05-24 18:53:28,911 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T18:53:28.776000'::timestamp AND timestamp <= '2025-05-24T18:53:28.776000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 18:53:28,942 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 18:53:29,240 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 18:53:29,669 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 18:53:29,790 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 18:53:29,802 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T18:53:29.689000'::timestamp AND timestamp <= '2025-05-24T18:53:29.689000'::timestamp;
2025-05-24 18:53:29,818 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T18:53:29.689000'::timestamp AND timestamp <= '2025-05-24T18:53:29.689000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 18:53:29,843 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 18:53:29,952 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 18:53:29,958 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 18:53:29,964 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 18:53:29,969 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 18:53:29,975 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 18:53:53,789 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 18:53:53,803 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 18:53:53,816 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: .\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_185337.dump catasto_storico
2025-05-24 18:55:02,345 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 18:55:02,357 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 18:55:02,375 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione ac093f0b...
2025-05-24 18:55:03,445 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 18:55:03,458 - CatastoDB - INFO - Disconnessione completata
2025-05-24 18:55:03,463 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 18:55:03,469 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 18:55:03,487 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:01:08,347 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:01:08,498 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:01:08,604 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:01:15,141 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:01:15,395 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:01:15,416 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 2ec4e9e7...
2025-05-24 19:01:15,422 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:01:15,434 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=2ec4e9e7...
2025-05-24 19:01:16,369 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:01:16,736 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:01:16,973 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:01:16,985 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:01:16.761000'::timestamp AND timestamp <= '2025-05-24T19:01:16.761000'::timestamp;
2025-05-24 19:01:17,002 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:01:16.761000'::timestamp AND timestamp <= '2025-05-24T19:01:16.761000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:01:17,034 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:01:17,356 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:01:17,755 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:01:17,870 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:01:17,881 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:01:17.771000'::timestamp AND timestamp <= '2025-05-24T19:01:17.771000'::timestamp;
2025-05-24 19:01:17,909 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:01:17.771000'::timestamp AND timestamp <= '2025-05-24T19:01:17.771000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:01:17,969 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:01:18,118 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:01:18,130 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:01:18,135 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:01:18,141 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:01:18,146 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:01:29,764 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 19:01:29,776 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 19:01:29,787 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: .\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_190124.dump catasto_storico
2025-05-24 19:10:09,393 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:10:09,541 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:10:09,666 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:10:15,702 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:10:15,962 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:10:15,983 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b5272b44...
2025-05-24 19:10:15,990 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:10:16,002 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=b5272b44...
2025-05-24 19:10:17,682 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:10:18,017 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:10:18,143 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:10:18,155 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:10:18.039000'::timestamp AND timestamp <= '2025-05-24T19:10:18.039000'::timestamp;
2025-05-24 19:10:18,173 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:10:18.039000'::timestamp AND timestamp <= '2025-05-24T19:10:18.039000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:10:18,204 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:10:18,625 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:10:18,886 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:10:19,006 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:10:19,018 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:10:18.910000'::timestamp AND timestamp <= '2025-05-24T19:10:18.910000'::timestamp;
2025-05-24 19:10:19,033 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:10:18.910000'::timestamp AND timestamp <= '2025-05-24T19:10:18.910000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:10:19,058 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:10:19,166 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:10:19,172 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:10:19,178 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:10:19,184 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:10:19,189 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:10:40,268 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 19:10:40,280 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 19:10:40,290 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: .\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_1915.dump catasto_storico
2025-05-24 19:15:26,073 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:15:26,085 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:15:26,105 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione b5272b44...
2025-05-24 19:15:27,064 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:15:27,070 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:15:27,075 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:15:27,081 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:15:27,094 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:15:34,955 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:15:35,077 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:15:35,186 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:15:50,154 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:15:50,412 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:15:50,423 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione eec439cc...
2025-05-24 19:15:50,429 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:15:50,442 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=eec439cc...
2025-05-24 19:15:51,281 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:15:51,728 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:15:51,972 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:15:51,984 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:15:51.749000'::timestamp AND timestamp <= '2025-05-24T19:15:51.749000'::timestamp;
2025-05-24 19:15:51,999 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:15:51.749000'::timestamp AND timestamp <= '2025-05-24T19:15:51.749000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:15:52,024 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:15:52,308 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:15:52,609 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:15:52,726 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:15:52,738 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:15:52.629000'::timestamp AND timestamp <= '2025-05-24T19:15:52.629000'::timestamp;
2025-05-24 19:15:52,754 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:15:52.629000'::timestamp AND timestamp <= '2025-05-24T19:15:52.629000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:15:52,778 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:15:52,887 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:15:52,893 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:15:52,898 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:15:52,904 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:15:52,909 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:16:19,335 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_199.dump catasto_storico
2025-05-24 19:20:26,640 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:20:26,751 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:20:26,981 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:20:31,470 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:20:31,726 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:20:31,737 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 9f8027b7...
2025-05-24 19:20:31,742 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:20:31,755 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=9f8027b7...
2025-05-24 19:20:32,450 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:20:32,777 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:20:32,897 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:20:32,909 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:20:32.797000'::timestamp AND timestamp <= '2025-05-24T19:20:32.797000'::timestamp;
2025-05-24 19:20:32,924 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:20:32.797000'::timestamp AND timestamp <= '2025-05-24T19:20:32.797000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:20:32,954 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:20:33,268 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:20:33,525 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:20:33,648 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:20:33,660 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:20:33.547000'::timestamp AND timestamp <= '2025-05-24T19:20:33.547000'::timestamp;
2025-05-24 19:20:33,674 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:20:33.547000'::timestamp AND timestamp <= '2025-05-24T19:20:33.547000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:20:33,698 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:20:33,809 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:20:33,815 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:20:33,821 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:20:33,827 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:20:33,833 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:21:06,662 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 19:21:06,677 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump' in: .\pg_dump.EXE
2025-05-24 19:21:06,688 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: .\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_199.dump catasto_storico
2025-05-24 19:21:32,903 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:21:32,916 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:21:32,932 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 9f8027b7...
2025-05-24 19:21:33,968 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:21:33,974 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:21:33,980 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:21:33,985 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:21:34,005 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:21:39,945 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:21:40,061 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:21:40,173 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:21:44,391 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:21:44,644 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:21:44,654 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 40b59d0a...
2025-05-24 19:21:44,659 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:21:44,672 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=40b59d0a...
2025-05-24 19:21:45,431 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:21:45,778 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:21:45,919 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:21:45,932 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:21:45.818000'::timestamp AND timestamp <= '2025-05-24T19:21:45.818000'::timestamp;
2025-05-24 19:21:45,947 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:21:45.818000'::timestamp AND timestamp <= '2025-05-24T19:21:45.818000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:21:45,970 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:21:46,271 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:21:46,544 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:21:46,668 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:21:46,694 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:21:46.563000'::timestamp AND timestamp <= '2025-05-24T19:21:46.563000'::timestamp;
2025-05-24 19:21:46,708 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:21:46.563000'::timestamp AND timestamp <= '2025-05-24T19:21:46.563000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:21:46,732 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:21:46,859 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:21:46,875 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:21:46,881 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:21:46,886 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:21:46,892 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:22:39,259 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_199.dump catasto_storico
2025-05-24 19:27:43,535 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:27:43,548 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:27:43,562 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 40b59d0a...
2025-05-24 19:27:44,681 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:27:44,687 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:27:44,692 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:27:44,698 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:27:44,713 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:27:54,339 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:27:54,592 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:27:54,699 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:27:59,178 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:27:59,432 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:27:59,441 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 52549ace...
2025-05-24 19:27:59,447 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:27:59,460 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=52549ace...
2025-05-24 19:28:00,246 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:28:00,596 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:28:00,718 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:28:00,730 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:28:00.617000'::timestamp AND timestamp <= '2025-05-24T19:28:00.617000'::timestamp;
2025-05-24 19:28:00,744 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:28:00.617000'::timestamp AND timestamp <= '2025-05-24T19:28:00.617000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:28:00,768 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:28:01,065 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:28:01,454 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:28:01,583 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:28:01,594 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:28:01.472000'::timestamp AND timestamp <= '2025-05-24T19:28:01.472000'::timestamp;
2025-05-24 19:28:01,610 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:28:01.472000'::timestamp AND timestamp <= '2025-05-24T19:28:01.472000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:28:01,634 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:28:01,750 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:28:01,756 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:28:01,761 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:28:01,768 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:28:01,774 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:29:32,185 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:29:32,312 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:29:32,417 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:29:37,124 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:29:37,380 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:29:37,410 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione dfcefc22...
2025-05-24 19:29:37,416 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:29:37,428 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=dfcefc22...
2025-05-24 19:29:38,136 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:29:38,465 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:29:38,588 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:29:38,600 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:29:38.486000'::timestamp AND timestamp <= '2025-05-24T19:29:38.486000'::timestamp;
2025-05-24 19:29:38,616 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:29:38.486000'::timestamp AND timestamp <= '2025-05-24T19:29:38.486000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:29:38,647 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:29:38,946 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:29:39,238 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:29:39,358 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:29:39,370 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:29:39.261000'::timestamp AND timestamp <= '2025-05-24T19:29:39.261000'::timestamp;
2025-05-24 19:29:39,394 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:29:39.261000'::timestamp AND timestamp <= '2025-05-24T19:29:39.261000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:29:39,432 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:29:39,549 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:29:39,555 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:29:39,561 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:29:39,567 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:29:39,572 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:29:53,909 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_dump.exe' nel PATH di sistema: .\pg_dump.exe
2025-05-24 19:29:53,921 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: .\pg_dump.exe -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_199.dump catasto_storico
2025-05-24 19:30:47,017 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:30:47,029 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:30:47,047 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione dfcefc22...
2025-05-24 19:30:48,080 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:30:48,087 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:30:48,092 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:30:48,098 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:30:48,121 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:30:54,763 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:30:54,879 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:30:54,986 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:30:59,844 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:31:00,097 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:31:00,107 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione bc144701...
2025-05-24 19:31:00,113 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:31:00,126 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=bc144701...
2025-05-24 19:31:01,563 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:31:01,886 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:31:02,005 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:31:02,017 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:31:01.904000'::timestamp AND timestamp <= '2025-05-24T19:31:01.904000'::timestamp;
2025-05-24 19:31:02,032 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:31:01.904000'::timestamp AND timestamp <= '2025-05-24T19:31:01.904000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:31:02,055 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:31:02,369 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:31:02,666 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:31:02,794 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:31:02,806 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:31:02.690000'::timestamp AND timestamp <= '2025-05-24T19:31:02.690000'::timestamp;
2025-05-24 19:31:02,820 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:31:02.690000'::timestamp AND timestamp <= '2025-05-24T19:31:02.690000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:31:02,856 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:31:02,970 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:31:02,976 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:31:02,982 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:31:02,988 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:31:02,994 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:31:17,855 - CatastoDB_catasto_storico_localhost - INFO - Utilizzo del percorso eseguibile fornito dall'utente: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE
2025-05-24 19:31:17,867 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/catasto_storico_backup_20250524_199.dump catasto_storico
2025-05-24 19:36:36,287 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:36:36,303 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:36:36,320 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione bc144701...
2025-05-24 19:36:37,535 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:36:37,542 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:36:37,548 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:36:37,560 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:36:37,575 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:37:25,138 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:37:25,252 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:37:25,360 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:37:30,615 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:37:30,878 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:37:30,890 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c3a55097...
2025-05-24 19:37:30,900 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:37:30,912 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=c3a55097...
2025-05-24 19:37:31,746 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:37:32,111 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:37:32,237 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:37:32,249 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:37:32.140000'::timestamp AND timestamp <= '2025-05-24T19:37:32.140000'::timestamp;
2025-05-24 19:37:32,275 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:37:32.140000'::timestamp AND timestamp <= '2025-05-24T19:37:32.140000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:37:32,311 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:44:00,975 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:44:01,127 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:44:01,237 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:44:07,557 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:44:07,817 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:44:07,842 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 106c08dd...
2025-05-24 19:44:07,848 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:44:07,861 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=106c08dd...
2025-05-24 19:44:08,701 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:44:09,037 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:44:09,162 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:44:09,173 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:44:09.059000'::timestamp AND timestamp <= '2025-05-24T19:44:09.059000'::timestamp;
2025-05-24 19:44:09,199 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:44:09.059000'::timestamp AND timestamp <= '2025-05-24T19:44:09.059000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:44:09,238 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:44:09,534 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:44:09,818 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:44:09,944 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:44:09,959 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:44:09.839000'::timestamp AND timestamp <= '2025-05-24T19:44:09.839000'::timestamp;
2025-05-24 19:44:09,973 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:44:09.839000'::timestamp AND timestamp <= '2025-05-24T19:44:09.839000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:44:09,999 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:44:10,115 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:44:10,122 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:44:10,128 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:44:10,136 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:44:10,142 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:45:46,191 - CatastoDB_catasto_storico_localhost - INFO - Utilizzo del percorso eseguibile fornito dall'utente: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE
2025-05-24 19:45:46,203 - CatastoDB_catasto_storico_localhost - INFO - Comando di backup preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -Fc --file U:/catasto/gemini/test_manuale_definitivo.dump catasto_storico
2025-05-24 19:46:15,865 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_restore.exe' nel PATH di sistema: C:\Program Files\PostgreSQL\17\bin\pg_restore.exe
2025-05-24 19:46:15,877 - CatastoDB_catasto_storico_localhost - INFO - Comando di ripristino preparato: C:\Program Files\PostgreSQL\17\bin\pg_restore.exe -U postgres -h localhost -p 5432 -d catasto_storico --clean --if-exists --verbose U:/catasto/gemini/test_manuale_definitivo.dump
2025-05-24 19:46:39,840 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:46:39,855 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:46:39,870 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 106c08dd...
2025-05-24 19:46:49,927 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:46:49,933 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:46:49,939 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:46:49,945 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:46:49,960 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:46:55,788 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:46:55,912 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:46:56,019 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:47:01,690 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:47:01,956 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:47:01,969 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 4a8ddbe7...
2025-05-24 19:47:01,975 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:47:01,987 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=4a8ddbe7...
2025-05-24 19:47:03,342 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:47:03,693 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:47:03,816 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:47:03,827 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:47:03.719000'::timestamp AND timestamp <= '2025-05-24T19:47:03.719000'::timestamp;
2025-05-24 19:47:03,842 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:47:03.719000'::timestamp AND timestamp <= '2025-05-24T19:47:03.719000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:47:03,866 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:47:04,159 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:47:04,551 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:47:04,768 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:47:04,780 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:47:04.574000'::timestamp AND timestamp <= '2025-05-24T19:47:04.574000'::timestamp;
2025-05-24 19:47:04,797 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:47:04.574000'::timestamp AND timestamp <= '2025-05-24T19:47:04.574000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:47:04,825 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:47:04,942 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:47:04,948 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:47:04,954 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:47:04,960 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:47:04,965 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:47:28,834 - CatastoDB_catasto_storico_localhost - INFO - Utilizzo del percorso eseguibile fornito dall'utente: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE
2025-05-24 19:47:28,846 - CatastoDB_catasto_storico_localhost - INFO - Comando di ripristino preparato: C:\Program Files\PostgreSQL\17\bin\pg_dump.EXE -U postgres -h localhost -p 5432 -d catasto_storico --clean --if-exists --verbose U:/catasto/gemini/test_manuale_definitivo.dump
2025-05-24 19:49:24,296 - CatastoDB_catasto_storico_localhost - INFO - Utilizzo del percorso eseguibile fornito dall'utente: C:\Program Files\PostgreSQL\17\bin\pg_restore.EXE
2025-05-24 19:49:24,307 - CatastoDB_catasto_storico_localhost - INFO - Comando di ripristino preparato: C:\Program Files\PostgreSQL\17\bin\pg_restore.EXE -U postgres -h localhost -p 5432 -d catasto_storico --clean --if-exists --verbose U:/catasto/gemini/test_manuale_definitivo.dump
2025-05-24 19:50:54,278 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:50:54,292 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:50:54,307 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 4a8ddbe7...
2025-05-24 19:51:06,129 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:51:06,135 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:51:06,143 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:51:06,150 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:51:06,164 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 19:51:14,898 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 19:51:15,012 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 19:51:15,121 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 19:51:19,499 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 19:51:19,754 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 19:51:19,766 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione fd3aa817...
2025-05-24 19:51:19,772 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:51:19,786 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=fd3aa817...
2025-05-24 19:51:21,306 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 19:51:21,649 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:51:21,768 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:51:21,779 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:51:21.670000'::timestamp AND timestamp <= '2025-05-24T19:51:21.670000'::timestamp;
2025-05-24 19:51:21,798 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:51:21.670000'::timestamp AND timestamp <= '2025-05-24T19:51:21.670000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:51:21,828 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:51:22,143 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 19:51:22,545 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 19:51:22,765 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:51:22,776 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T19:51:22.552000'::timestamp AND timestamp <= '2025-05-24T19:51:22.552000'::timestamp;
2025-05-24 19:51:22,794 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T19:51:22.552000'::timestamp AND timestamp <= '2025-05-24T19:51:22.552000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 19:51:22,821 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 19:51:22,958 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 19:51:22,964 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 19:51:22,970 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 19:51:22,976 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 19:51:22,982 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 19:51:43,311 - CatastoDB_catasto_storico_localhost - INFO - Trovato eseguibile 'pg_restore.exe' nel PATH di sistema: C:\Program Files\PostgreSQL\17\bin\pg_restore.exe
2025-05-24 19:51:43,338 - CatastoDB_catasto_storico_localhost - INFO - Comando di ripristino preparato: C:\Program Files\PostgreSQL\17\bin\pg_restore.exe -U postgres -h localhost -p 5432 -d catasto_storico --clean --if-exists --verbose U:/catasto/gemini/catasto_storico_backup_20250524_199.dump
2025-05-24 19:55:05,379 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 19:55:05,391 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 19:55:05,409 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione fd3aa817...
2025-05-24 19:55:06,507 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 19:55:06,516 - CatastoDB - INFO - Disconnessione completata
2025-05-24 19:55:06,521 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 19:55:06,529 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 19:55:06,547 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 20:15:57,667 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 20:16:06,076 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 20:16:06,268 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 20:16:15,095 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 20:16:15,401 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 20:16:15,480 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 44a33259...
2025-05-24 20:16:15,536 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:16:15,653 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=44a33259...
2025-05-24 20:16:16,820 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 20:16:18,109 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:16:18,157 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:16:18,207 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:16:18,257 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:16:18,339 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 20:16:18,505 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:16:18,602 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T20:16:18.400000'::timestamp AND timestamp <= '2025-05-24T20:16:18.400000'::timestamp;
2025-05-24 20:16:18,725 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T20:16:18.400000'::timestamp AND timestamp <= '2025-05-24T20:16:18.400000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 20:16:18,860 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 20:16:20,227 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 20:16:20,534 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:16:20,588 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:16:20,642 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:16:20,697 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:16:20,764 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 20:16:20,970 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:16:21,078 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T20:16:20.832000'::timestamp AND timestamp <= '2025-05-24T20:16:20.832000'::timestamp;
2025-05-24 20:16:21,191 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T20:16:20.832000'::timestamp AND timestamp <= '2025-05-24T20:16:20.832000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 20:16:21,331 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 20:16:21,552 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 20:16:21,607 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 20:16:21,661 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 20:16:21,716 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 20:16:21,773 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 20:17:10,782 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:17:10,942 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 20:17:11,103 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 44a33259...
2025-05-24 20:17:12,295 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 20:17:12,379 - CatastoDB - INFO - Disconnessione completata
2025-05-24 20:17:12,461 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 20:17:12,545 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 20:17:12,654 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 20:23:20,012 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 20:23:20,256 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 20:23:20,476 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 20:23:32,774 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 20:23:33,050 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 20:23:33,093 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 60a2ee2f...
2025-05-24 20:23:33,119 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:23:33,174 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=60a2ee2f...
2025-05-24 20:23:34,627 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 20:23:35,659 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:23:35,688 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:23:35,718 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:23:35,777 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:23:35,816 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 20:23:35,955 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:23:36,012 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T20:23:35.861000'::timestamp AND timestamp <= '2025-05-24T20:23:35.861000'::timestamp;
2025-05-24 20:23:36,086 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T20:23:35.861000'::timestamp AND timestamp <= '2025-05-24T20:23:35.861000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 20:23:36,175 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 20:23:37,149 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 20:23:37,433 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:23:37,463 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:23:37,493 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 20:23:37,524 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 20:23:37,586 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 20:23:37,734 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:23:37,794 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T20:23:37.623000'::timestamp AND timestamp <= '2025-05-24T20:23:37.623000'::timestamp;
2025-05-24 20:23:37,861 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T20:23:37.623000'::timestamp AND timestamp <= '2025-05-24T20:23:37.623000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 20:23:37,954 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 20:23:38,139 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 20:23:38,169 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 20:23:38,199 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 20:23:38,229 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 20:23:38,259 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 20:24:17,587 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:24:17,656 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1014, tipo = 'principale', stato = 'inattiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-24 20:24:17,733 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1109: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.

2025-05-24 20:24:21,111 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 20:24:21,182 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1014, tipo = 'principale', stato = 'inattiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-24 20:24:21,265 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1109: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.

2025-05-24 20:24:25,883 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 20:24:26,071 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 20:24:26,144 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 20:24:26,219 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1014, tipo = 'principale', stato = 'inattiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = 1, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-24 20:24:26,297 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1109: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.

2025-05-24 20:24:27,456 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 20:24:27,652 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 20:24:27,730 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 20:24:27,808 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1014, tipo = 'principale', stato = 'inattiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = 1, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-24 20:24:27,887 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1109: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1014) esiste gi‡.

2025-05-24 20:24:32,123 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 20:24:32,438 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 20:24:32,545 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 20:24:32,657 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 20:24:32,772 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 60a2ee2f...
2025-05-24 20:24:34,442 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 20:24:34,512 - CatastoDB - INFO - Disconnessione completata
2025-05-24 20:24:34,578 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 20:24:34,646 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 20:24:34,735 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-24 21:07:50,399 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-24 21:07:50,511 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-24 21:07:50,617 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-24 21:07:55,233 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-24 21:07:55,501 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-24 21:07:55,509 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 1aad70a5...
2025-05-24 21:07:55,515 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 21:07:55,528 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=1aad70a5...
2025-05-24 21:07:57,202 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-24 21:07:57,533 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 21:07:57,539 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 21:07:57,546 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 21:07:57,552 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 21:07:57,571 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 21:07:57,695 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 21:07:57,707 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T21:07:57.593000'::timestamp AND timestamp <= '2025-05-24T21:07:57.593000'::timestamp;
2025-05-24 21:07:57,721 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T21:07:57.593000'::timestamp AND timestamp <= '2025-05-24T21:07:57.593000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 21:07:57,745 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 21:07:57,910 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-24 21:07:58,165 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 21:07:58,171 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 21:07:58,178 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-24 21:07:58,185 - CatastoDB - INFO - Rollback eseguito.
2025-05-24 21:07:58,205 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-24 21:07:58,324 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 21:07:58,335 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-23T21:07:58.224000'::timestamp AND timestamp <= '2025-05-24T21:07:58.224000'::timestamp;
2025-05-24 21:07:58,350 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-23T21:07:58.224000'::timestamp AND timestamp <= '2025-05-24T21:07:58.224000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-24 21:07:58,374 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-24 21:07:58,483 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-24 21:07:58,489 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-24 21:07:58,495 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-24 21:07:58,501 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-24 21:07:58,507 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-24 21:08:12,140 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 21:08:12,152 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1008, tipo = 'principale', stato = 'attiva', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-24 21:08:12,167 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-24 21:08:12,279 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-24 21:08:12,293 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1008, tipo = 'principale', stato = 'attiva', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-24 21:08:12,307 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-24 21:08:27,266 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 21:08:27,364 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 21:08:27,377 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 21:08:27,391 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1016, tipo = 'principale', stato = 'attiva', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-24 21:08:27,406 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1107: ERRORE:  serializzazione dell'accesso fallita a causa di modifiche concorrenti
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.SerializationFailure: ERRORE:  serializzazione dell'accesso fallita a causa di modifiche concorrenti

2025-05-24 21:08:29,310 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 21:08:29,341 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 21:08:29,354 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 21:08:29,365 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1016, tipo = 'principale', stato = 'attiva', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-24 21:08:29,379 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1107: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1016) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1016) esiste gi‡.

2025-05-24 21:08:33,674 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-24 21:08:33,702 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-24 21:08:33,714 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-24 21:08:33,725 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-24 21:08:33,739 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 1aad70a5...
2025-05-24 21:08:35,051 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-24 21:08:35,058 - CatastoDB - INFO - Disconnessione completata
2025-05-24 21:08:35,066 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-24 21:08:35,072 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-24 21:08:35,090 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 09:01:05,925 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 09:01:06,071 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 09:01:06,174 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 09:01:16,395 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 09:01:16,653 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 09:01:16,687 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7d032248...
2025-05-25 09:01:16,693 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:01:16,706 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=7d032248...
2025-05-25 09:01:17,863 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 09:01:18,202 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:01:18,212 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:01:18,221 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:01:18,227 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:01:18,244 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 09:01:18,365 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:01:18,376 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T09:01:18.259000'::timestamp AND timestamp <= '2025-05-25T09:01:18.259000'::timestamp;
2025-05-25 09:01:18,402 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T09:01:18.259000'::timestamp AND timestamp <= '2025-05-25T09:01:18.259000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 09:01:18,488 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 09:01:18,649 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 09:01:18,900 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:01:18,907 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:01:18,914 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:01:18,920 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:01:18,939 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 09:01:19,062 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:01:19,073 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T09:01:18.965000'::timestamp AND timestamp <= '2025-05-25T09:01:18.965000'::timestamp;
2025-05-25 09:01:19,088 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T09:01:18.965000'::timestamp AND timestamp <= '2025-05-25T09:01:18.965000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 09:01:19,113 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 09:01:19,224 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 09:01:19,230 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 09:01:19,236 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 09:01:19,242 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 09:01:19,248 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 09:01:58,908 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:01:58,920 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1009, tipo = 'principale', stato = 'attiva', data_impianto = '2024-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1669;
        
2025-05-25 09:01:58,937 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1669 aggiornata con successo. Righe modificate: 1
2025-05-25 09:01:59,069 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:01:59,082 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1009, tipo = 'principale', stato = 'attiva', data_impianto = '2024-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1669;
        
2025-05-25 09:01:59,098 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1669 aggiornata con successo. Righe modificate: 1
2025-05-25 09:02:12,897 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 09:02:12,999 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 09:02:13,015 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 09:02:13,031 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 09:02:13,050 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 7d032248...
2025-05-25 09:02:14,218 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 09:02:14,225 - CatastoDB - INFO - Disconnessione completata
2025-05-25 09:02:14,231 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 09:02:14,236 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 09:02:14,255 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 09:02:42,260 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 09:02:42,373 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 09:02:42,481 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 09:02:47,471 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 09:02:47,730 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 06f6ea86...
2025-05-25 09:04:13,990 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:04:14,002 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 09:04:14,018 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 06f6ea86...
2025-05-25 09:04:14,026 - CatastoDB - INFO - Disconnessione completata
2025-05-25 09:04:23,317 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 09:04:23,436 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 09:04:23,539 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 09:04:29,822 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 09:04:30,072 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 09:04:30,082 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione b931e302...
2025-05-25 09:04:30,087 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:04:30,101 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=b931e302...
2025-05-25 09:04:31,063 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 09:04:31,388 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:04:31,394 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:04:31,401 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:04:31,407 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:04:31,423 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 09:04:31,543 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:04:31,555 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T09:04:31.445000'::timestamp AND timestamp <= '2025-05-25T09:04:31.445000'::timestamp;
2025-05-25 09:04:31,569 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T09:04:31.445000'::timestamp AND timestamp <= '2025-05-25T09:04:31.445000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 09:04:31,598 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 09:04:31,763 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 09:04:32,015 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:04:32,021 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:04:32,029 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:04:32,036 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:04:32,067 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 09:04:32,188 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:04:32,199 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T09:04:32.089000'::timestamp AND timestamp <= '2025-05-25T09:04:32.089000'::timestamp;
2025-05-25 09:04:32,214 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T09:04:32.089000'::timestamp AND timestamp <= '2025-05-25T09:04:32.089000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 09:04:32,237 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 09:04:32,345 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 09:04:32,351 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 09:04:32,356 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 09:04:32,362 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 09:04:32,368 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 09:05:52,148 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 2, Partita N.1
2025-05-25 09:06:15,733 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:06:15,746 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 09:06:15,759 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione b931e302...
2025-05-25 09:06:17,044 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 09:06:17,051 - CatastoDB - INFO - Disconnessione completata
2025-05-25 09:06:17,056 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 09:06:17,062 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 09:06:17,082 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 09:06:22,606 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 09:06:22,851 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 09:06:22,987 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 09:06:27,014 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 09:06:27,272 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 09:06:27,281 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione bd387128...
2025-05-25 09:06:27,286 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:06:27,298 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=bd387128...
2025-05-25 09:06:28,146 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 09:06:28,464 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:06:28,470 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:06:28,477 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:06:28,483 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:06:28,501 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 09:06:28,740 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:06:28,757 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T09:06:28.525000'::timestamp AND timestamp <= '2025-05-25T09:06:28.525000'::timestamp;
2025-05-25 09:06:28,774 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T09:06:28.525000'::timestamp AND timestamp <= '2025-05-25T09:06:28.525000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 09:06:28,802 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 09:06:28,968 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 09:06:29,265 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:06:29,270 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:06:29,277 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 09:06:29,283 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 09:06:29,300 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 09:06:29,448 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:06:29,459 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T09:06:29.350000'::timestamp AND timestamp <= '2025-05-25T09:06:29.350000'::timestamp;
2025-05-25 09:06:29,474 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T09:06:29.350000'::timestamp AND timestamp <= '2025-05-25T09:06:29.350000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 09:06:29,499 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 09:06:29,615 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 09:06:29,621 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 09:06:29,626 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 09:06:29,632 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 09:06:29,637 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 09:07:02,451 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 09:07:02,464 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 09:07:02,477 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione bd387128...
2025-05-25 09:07:03,597 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 09:07:03,603 - CatastoDB - INFO - Disconnessione completata
2025-05-25 09:07:03,611 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 09:07:03,617 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 09:07:03,631 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 11:29:38,905 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 11:29:39,066 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 11:29:39,173 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 11:29:46,793 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 11:29:47,053 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 11:29:47,073 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 32ef1cb2...
2025-05-25 11:29:47,078 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 11:29:47,091 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=32ef1cb2...
2025-05-25 11:29:49,135 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 11:29:49,457 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 11:29:49,463 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 11:29:49,470 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 11:29:49,476 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 11:29:49,492 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 11:29:49,630 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 11:29:49,641 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T11:29:49.521000'::timestamp AND timestamp <= '2025-05-25T11:29:49.521000'::timestamp;
2025-05-25 11:29:49,659 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T11:29:49.521000'::timestamp AND timestamp <= '2025-05-25T11:29:49.521000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 11:29:49,699 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 11:29:49,890 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 11:29:50,129 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 11:29:50,148 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 11:29:50,154 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 11:29:50,160 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 11:29:50,177 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 11:29:50,292 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 11:29:50,304 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T11:29:50.194000'::timestamp AND timestamp <= '2025-05-25T11:29:50.194000'::timestamp;
2025-05-25 11:29:50,319 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T11:29:50.194000'::timestamp AND timestamp <= '2025-05-25T11:29:50.194000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 11:29:50,342 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 11:29:50,483 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 11:29:50,489 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 11:29:50,495 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 11:29:50,500 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 11:29:50,506 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 11:30:36,592 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 11:30:36,605 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 11:30:36,626 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 32ef1cb2...
2025-05-25 11:30:38,208 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 11:30:38,215 - CatastoDB - INFO - Disconnessione completata
2025-05-25 11:30:38,220 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 11:30:38,225 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 11:30:38,242 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 12:14:41,072 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 12:14:41,204 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 12:14:41,307 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 12:14:50,129 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 12:14:50,384 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 12:14:50,394 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione eaef7a1f...
2025-05-25 12:14:50,400 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:14:50,413 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=eaef7a1f...
2025-05-25 12:14:51,282 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 12:14:51,617 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:14:51,623 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:14:51,632 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:14:51,638 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:14:51,658 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 12:14:51,792 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:14:51,804 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T12:14:51.692000'::timestamp AND timestamp <= '2025-05-25T12:14:51.692000'::timestamp;
2025-05-25 12:14:51,822 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T12:14:51.692000'::timestamp AND timestamp <= '2025-05-25T12:14:51.692000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 12:14:51,870 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 12:14:52,039 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 12:14:52,351 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:14:52,357 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:14:52,364 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:14:52,370 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:14:52,387 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 12:14:52,507 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:14:52,519 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T12:14:52.402000'::timestamp AND timestamp <= '2025-05-25T12:14:52.402000'::timestamp;
2025-05-25 12:14:52,535 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T12:14:52.402000'::timestamp AND timestamp <= '2025-05-25T12:14:52.402000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 12:14:52,558 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 12:14:52,669 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 12:14:52,675 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 12:14:52,680 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 12:14:52,686 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 12:14:52,693 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 12:15:30,560 - CatastoDB - INFO - Localit‡ 'Regione Sticazzi' (Comune ID: 3) inserita con ID: 101
2025-05-25 12:16:08,925 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:16:08,936 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1010, tipo = 'principale', stato = 'attiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-25 12:16:08,952 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1109 aggiornata con successo. Righe modificate: 1
2025-05-25 12:16:09,093 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:16:09,106 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1010, tipo = 'principale', stato = 'attiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-25 12:16:09,130 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1109 aggiornata con successo. Righe modificate: 1
2025-05-25 12:16:21,046 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:16:21,144 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:16:21,156 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:16:21,169 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1010, tipo = 'principale', stato = 'attiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-25 12:16:21,183 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1109: ERRORE:  serializzazione dell'accesso fallita a causa di modifiche concorrenti
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.SerializationFailure: ERRORE:  serializzazione dell'accesso fallita a causa di modifiche concorrenti

2025-05-25 12:16:22,491 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:16:22,526 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:16:22,539 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:16:22,553 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1010, tipo = 'principale', stato = 'attiva', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-25 12:16:22,573 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1109 aggiornata con successo. Righe modificate: 1
2025-05-25 12:16:32,230 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:16:32,271 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:16:32,284 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:16:32,299 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1007, tipo = 'secondaria', stato = 'attiva', data_impianto = '1995-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1106;
        
2025-05-25 12:16:32,313 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1106 aggiornata con successo. Righe modificate: 1
2025-05-25 12:16:32,328 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:16:32,359 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:16:32,371 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:16:32,383 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1007, tipo = 'secondaria', stato = 'attiva', data_impianto = '1995-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1106;
        
2025-05-25 12:16:32,397 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1106 aggiornata con successo. Righe modificate: 1
2025-05-25 12:16:44,134 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:16:44,174 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:16:44,186 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:16:44,199 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1009, tipo = 'secondaria', stato = 'attiva', data_impianto = '1995-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1106;
        
2025-05-25 12:16:44,215 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1106: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1009) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1009) esiste gi‡.

2025-05-25 12:16:49,370 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:16:49,402 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:16:49,417 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:16:49,431 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 1009, tipo = 'secondaria', stato = 'attiva', data_impianto = '1995-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1106;
        
2025-05-25 12:16:49,449 - CatastoDB_catasto_storico_localhost - ERROR - Errore DB durante l'aggiornamento della partita ID 1106: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1009) esiste gi‡.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 698, in update_partita
    cur.execute(query, tuple(params))
    ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^
psycopg2.errors.UniqueViolation: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 1009) esiste gi‡.

2025-05-25 12:18:08,224 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: CALL registra_nuova_proprieta(%s, %s, %s, %s::json, %s::json)... Errore: ERRORE:  [registra_nuova_proprieta] Errore: La partita 1010 gi√† esiste nel comune con ID 1
CONTEXT:  funzione PL/pgSQL registra_nuova_proprieta(integer,integer,date,json,json) riga 40 a RAISE

2025-05-25 12:18:08,230 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:18:44,922 - CatastoDB - INFO - Registrata nuova propriet‡: Comune ID 1, Partita N.2000
2025-05-25 12:21:05,589 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:21:05,790 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:21:05,812 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:21:05,823 - CatastoDB_catasto_storico_localhost - DEBUG - Chiamata a catasto.ricerca_avanzata_immobili con parametri POSIZIONALI: (None, None, None, None, None, None, None, None, None, None, None, None)
2025-05-25 12:21:05,992 - CatastoDB_catasto_storico_localhost - INFO - Ricerca avanzata immobili ha restituito 7502 risultati.
2025-05-25 12:23:27,104 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:23:27,145 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:23:27,156 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:23:27,167 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2001, tipo = 'principale', stato = 'attiva', data_impianto = '2024-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1108;
        
2025-05-25 12:23:27,180 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1108 aggiornata con successo. Righe modificate: 1
2025-05-25 12:23:27,196 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:23:27,226 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:23:27,238 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:23:27,250 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2001, tipo = 'principale', stato = 'attiva', data_impianto = '2024-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1108;
        
2025-05-25 12:23:27,264 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1108 aggiornata con successo. Righe modificate: 1
2025-05-25 12:29:44,577 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:29:44,646 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:29:44,659 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:29:44,672 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'principale', stato = 'inattiva', data_impianto = '1991-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:29:44,686 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:29:44,701 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:29:44,732 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:29:44,744 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:29:44,756 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'principale', stato = 'inattiva', data_impianto = '1991-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:29:44,769 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:35:11,913 - CatastoDB - INFO - Ricerca avanzata possessori per 'stress' (soglia: 0.2) ha prodotto 100 risultati.
2025-05-25 12:36:56,791 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:36:56,830 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:36:56,842 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:36:56,853 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'secondaria', stato = 'inattiva', data_impianto = '1991-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:36:56,866 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:36:56,880 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:36:56,914 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:36:56,926 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:36:56,938 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'secondaria', stato = 'inattiva', data_impianto = '1991-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = NULL, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:36:56,950 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:37:08,047 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:37:08,088 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:37:08,100 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:37:08,112 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'secondaria', stato = 'inattiva', data_impianto = '1991-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = 3, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:37:08,128 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:37:08,153 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:37:08,183 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:37:08,194 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:37:08,206 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'secondaria', stato = 'inattiva', data_impianto = '1991-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = 3, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:37:08,220 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:37:41,088 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:37:41,129 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:37:41,141 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:37:41,154 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'secondaria', stato = 'inattiva', data_impianto = '2017-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = 3, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:37:41,168 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:37:41,184 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:37:41,215 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:37:41,230 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:37:41,244 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita: 
            UPDATE catasto.partita
            SET numero_partita = 2012, tipo = 'secondaria', stato = 'inattiva', data_impianto = '2017-05-24'::date, data_chiusura = '2025-04-14'::date, numero_provenienza = 3, data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1111;
        
2025-05-25 12:37:41,260 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1111 aggiornata con successo. Righe modificate: 1
2025-05-25 12:50:16,570 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 148, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:50:16,630 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:50:16,643 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:50:16,659 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 12:50:16,677 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione eaef7a1f...
2025-05-25 12:50:18,033 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 12:50:18,040 - CatastoDB - INFO - Disconnessione completata
2025-05-25 12:50:18,046 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 12:50:18,052 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 12:50:18,077 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 12:56:36,188 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 12:56:36,345 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 12:56:36,462 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 12:56:42,036 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 12:56:42,295 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 12:56:42,310 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5edbb705...
2025-05-25 12:56:42,316 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:56:42,329 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=5edbb705...
2025-05-25 12:57:19,182 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 12:57:19,524 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:57:19,530 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:57:19,538 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:57:19,544 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:57:19,564 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 12:57:19,688 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:57:19,700 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T12:57:19.583000'::timestamp AND timestamp <= '2025-05-25T12:57:19.583000'::timestamp;
2025-05-25 12:57:19,716 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T12:57:19.583000'::timestamp AND timestamp <= '2025-05-25T12:57:19.583000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 12:57:19,758 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 12:57:19,924 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 12:57:20,199 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:57:20,207 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:57:20,213 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 12:57:20,222 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 12:57:20,240 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 12:57:20,356 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:57:20,368 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T12:57:20.254000'::timestamp AND timestamp <= '2025-05-25T12:57:20.254000'::timestamp;
2025-05-25 12:57:20,385 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T12:57:20.254000'::timestamp AND timestamp <= '2025-05-25T12:57:20.254000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 12:57:20,409 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 12:57:20,525 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 12:57:20,531 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 12:57:20,537 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 12:57:20,543 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 12:57:20,549 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 12:57:43,894 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:57:43,906 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:57:44,000 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1714, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati) # <--- USA QUESTA ORA
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:57:46,145 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 12:57:46,157 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:57:46,188 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1730, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati)
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:57:54,913 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:57:54,954 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:57:54,967 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:57:54,981 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:57:55,017 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1714, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati) # <--- USA QUESTA ORA
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:58:00,784 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:58:00,816 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:58:00,828 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:58:00,850 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:58:00,890 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1730, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati)
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:58:26,146 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:58:26,186 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:58:26,198 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:58:26,210 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:58:26,238 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1714, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati) # <--- USA QUESTA ORA
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:58:27,367 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:58:27,398 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:58:27,410 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:58:27,428 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:58:27,459 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1730, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati)
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:58:34,290 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:58:34,318 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:58:34,329 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:58:34,341 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:58:34,369 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1714, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati) # <--- USA QUESTA ORA
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:58:35,670 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:58:35,698 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:58:35,710 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:58:35,722 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:58:35,753 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1730, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati)
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:59:12,651 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:59:12,691 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:59:12,704 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:59:12,716 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:59:12,747 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1714, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati) # <--- USA QUESTA ORA
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 12:59:14,023 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 12:59:14,052 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 12:59:14,064 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 12:59:14,075 - CatastoDB_catasto_storico_localhost - ERROR - Errore imprevisto durante l'aggiornamento della partita ID 1109: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting
2025-05-25 12:59:14,107 - CatastoGUI - ERROR - Errore durante il salvataggio delle modifiche alla partita ID 1109: Errore imprevisto: not all arguments converted during string formatting
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 717, in update_partita
    self.logger.debug(f"Esecuzione query UPDATE partita: {cur.mogrify(query, params_tuple).decode('utf-8', 'ignore')}")
                                                          ~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^
TypeError: not all arguments converted during string formatting

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "U:\catasto\gemini\prova.py", line 1730, in _save_changes
    success = self.db_manager.update_partita(self.partita_id, dati_modificati)
  File "U:\catasto\gemini\catasto_db_manager.py", line 755, in update_partita
    raise DBMError(f"Errore imprevisto: {e}") from e
catasto_db_manager.DBMError: Errore imprevisto: not all arguments converted during string formatting
2025-05-25 13:03:31,168 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 13:03:31,210 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 13:03:31,222 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 13:03:31,235 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 13:03:31,262 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 5edbb705...
2025-05-25 13:03:32,594 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 13:03:32,600 - CatastoDB - INFO - Disconnessione completata
2025-05-25 13:03:32,606 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 13:03:32,612 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 13:03:32,631 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 13:03:41,015 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 13:03:41,137 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 13:03:41,325 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 13:03:47,961 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 13:03:48,221 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 13:03:48,231 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 40a9c1f0...
2025-05-25 13:03:48,237 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:03:48,250 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=40a9c1f0...
2025-05-25 13:03:49,106 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 13:03:49,422 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:03:49,428 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:03:49,437 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:03:49,443 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:03:49,462 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 13:03:49,710 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:03:49,721 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T13:03:49.492000'::timestamp AND timestamp <= '2025-05-25T13:03:49.492000'::timestamp;
2025-05-25 13:03:49,739 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T13:03:49.492000'::timestamp AND timestamp <= '2025-05-25T13:03:49.492000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 13:03:49,783 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 13:03:49,950 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 13:03:50,210 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:03:50,216 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:03:50,223 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:03:50,229 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:03:50,249 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 13:03:50,379 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:03:50,390 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T13:03:50.272000'::timestamp AND timestamp <= '2025-05-25T13:03:50.272000'::timestamp;
2025-05-25 13:03:50,406 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T13:03:50.272000'::timestamp AND timestamp <= '2025-05-25T13:03:50.272000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 13:03:50,430 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 13:03:50,550 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 13:03:50,555 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 13:03:50,561 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 13:03:50,567 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 13:03:50,572 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 13:04:04,323 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:04:04,335 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1109: 
            UPDATE catasto.partita
            SET numero_partita = 3000, tipo = 'principale', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-25 13:04:04,350 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1109 aggiornata con successo. Righe modificate: 1
2025-05-25 13:04:08,802 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:04:08,815 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1109: 
            UPDATE catasto.partita
            SET numero_partita = 3000, tipo = 'principale', data_impianto = '2019-05-24'::date, data_chiusura = '2025-04-07'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1109;
        
2025-05-25 13:04:08,831 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1109 aggiornata con successo. Righe modificate: 1
2025-05-25 13:04:15,112 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 161, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 13:04:15,209 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 13:04:15,222 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 13:04:15,236 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 13:04:15,251 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 40a9c1f0...
2025-05-25 13:04:16,461 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 13:04:16,468 - CatastoDB - INFO - Disconnessione completata
2025-05-25 13:04:16,474 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 13:04:16,480 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 13:04:16,498 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 13:07:47,528 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 13:07:47,750 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 13:07:47,860 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 13:07:52,094 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 13:07:52,358 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 13:07:52,368 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 54b77164...
2025-05-25 13:07:52,373 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:07:52,387 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=54b77164...
2025-05-25 13:07:53,418 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 13:07:53,791 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:07:53,798 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:07:53,805 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:07:53,812 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:07:53,832 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 13:07:53,957 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:07:53,983 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T13:07:53.856000'::timestamp AND timestamp <= '2025-05-25T13:07:53.856000'::timestamp;
2025-05-25 13:07:54,000 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T13:07:53.856000'::timestamp AND timestamp <= '2025-05-25T13:07:53.856000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 13:07:54,032 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 13:07:54,218 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 13:07:54,482 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:07:54,488 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:07:54,495 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 13:07:54,501 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 13:07:54,521 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 13:07:54,765 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:07:54,778 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T13:07:54.546000'::timestamp AND timestamp <= '2025-05-25T13:07:54.546000'::timestamp;
2025-05-25 13:07:54,793 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Data Query: 
            SELECT id, timestamp, app_user_id, session_id, tabella, operazione, record_id, ip_address, utente, dati_prima, dati_dopo
            FROM catasto.audit_log
            WHERE timestamp >= '2025-05-24T13:07:54.546000'::timestamp AND timestamp <= '2025-05-25T13:07:54.546000'::timestamp
            ORDER BY timestamp DESC, id DESC
            LIMIT 100 OFFSET 0;
        
2025-05-25 13:07:54,817 - CatastoDB_catasto_storico_localhost - INFO - Recuperati 100 record di audit log (pagina 1 di 152). Totale filtrati: 15194
2025-05-25 13:07:54,937 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 13:07:54,943 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 13:07:54,949 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 13:07:54,954 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 13:07:54,960 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 13:08:06,291 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:08:06,302 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 3000, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 13:08:06,319 - CatastoDB_catasto_storico_localhost - ERROR - Errore di violazione di unicit‡ (vincolo: partita_comune_id_numero_partita_key) durante l'aggiornamento della partita ID 1107: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 3000) esiste gi‡.

2025-05-25 13:08:13,745 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 13:08:13,756 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 3000, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 13:08:13,776 - CatastoDB_catasto_storico_localhost - ERROR - Errore di violazione di unicit‡ (vincolo: partita_comune_id_numero_partita_key) durante l'aggiornamento della partita ID 1107: ERRORE:  un valore chiave duplicato viola il vincolo univoco "partita_comune_id_numero_partita_key"
DETAIL:  La chiave (comune_id, numero_partita)=(3, 3000) esiste gi‡.

2025-05-25 13:08:43,147 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 166, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 13:08:43,189 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 13:08:43,201 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 13:08:43,213 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1142: 
            UPDATE catasto.partita
            SET numero_partita = 3727, tipo = 'principale', data_impianto = '2022-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1142;
        
2025-05-25 13:08:43,228 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1142 aggiornata con successo. Righe modificate: 1
2025-05-25 13:08:45,002 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 166, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 13:08:45,032 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 13:08:45,044 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 13:08:45,058 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1142: 
            UPDATE catasto.partita
            SET numero_partita = 3727, tipo = 'principale', data_impianto = '2022-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1142;
        
2025-05-25 13:08:45,073 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1142 aggiornata con successo. Righe modificate: 1
2025-05-25 13:12:31,590 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 166, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 13:12:31,632 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 13:12:31,644 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 13:12:31,657 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1142: 
            UPDATE catasto.partita
            SET numero_partita = 3728, tipo = 'principale', data_impianto = '2022-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1142;
        
2025-05-25 13:12:31,671 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1142 aggiornata con successo. Righe modificate: 1
2025-05-25 13:12:50,139 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 166, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 13:12:50,180 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 13:12:50,192 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 13:12:50,204 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1142: 
            UPDATE catasto.partita
            SET numero_partita = 3728, tipo = 'principale', data_impianto = '2022-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1142;
        
2025-05-25 13:12:50,224 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1142 aggiornata con successo. Righe modificate: 1
2025-05-25 14:28:24,080 - CatastoDB_catasto_storico_localhost - ERROR - Errore nell'ottenere una connessione dal pool: connection pool exhausted. Tento fallback su connessione singola.
Traceback (most recent call last):
  File "U:\catasto\gemini\catasto_db_manager.py", line 166, in _get_connection
    conn = self.pool.getconn()
  File "C:\Users\ipabcrmm\AppData\Roaming\Python\Python313\site-packages\psycopg2\pool.py", line 92, in _getconn
    raise PoolError("connection pool exhausted")
psycopg2.pool.PoolError: connection pool exhausted
2025-05-25 14:28:24,120 - CatastoDB_catasto_storico_localhost - DEBUG - Pool non disponibile o errore, tento di usare/stabilire connessione singola.
2025-05-25 14:28:24,131 - CatastoDB_catasto_storico_localhost - DEBUG - Utilizzo della connessione singola esistente. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432
2025-05-25 14:28:24,145 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 14:28:24,161 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 54b77164...
2025-05-25 14:28:25,194 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 14:28:25,202 - CatastoDB - INFO - Disconnessione completata
2025-05-25 14:28:25,207 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 14:28:25,213 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 14:28:25,227 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 14:28:33,888 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 14:28:34,009 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 14:28:34,117 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 14:28:39,859 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 14:28:40,148 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 14:28:40,158 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 7753a0b5...
2025-05-25 14:28:40,165 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:28:40,182 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=7753a0b5...
2025-05-25 14:28:41,644 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 14:28:42,017 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:28:42,023 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:28:42,030 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:28:42,035 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:28:42,054 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 14:28:42,175 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:28:42,186 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T14:28:42.077000'::timestamp AND timestamp <= '2025-05-25T14:28:42.077000'::timestamp;
2025-05-25 14:28:42,208 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 14:28:42,311 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 14:28:42,515 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:28:42,521 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:28:42,528 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:28:42,534 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:28:42,554 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 14:28:42,680 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:28:42,692 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T14:28:42.576000'::timestamp AND timestamp <= '2025-05-25T14:28:42.576000'::timestamp;
2025-05-25 14:28:42,705 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 14:28:42,742 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 14:28:42,747 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 14:28:42,753 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 14:28:42,758 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 14:28:42,764 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 14:28:56,531 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:28:56,543 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1110: 
            UPDATE catasto.partita
            SET numero_partita = 3258, tipo = 'principale', data_impianto = '2001-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1110;
        
2025-05-25 14:28:56,557 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1110 aggiornata con successo. Righe modificate: 1
2025-05-25 14:36:21,865 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 14:36:22,013 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 14:36:22,122 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 14:36:27,688 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 14:36:27,944 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 14:36:27,966 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 01c3a66f...
2025-05-25 14:36:27,972 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:36:27,984 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=01c3a66f...
2025-05-25 14:36:29,330 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 14:36:29,673 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:36:29,679 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:36:29,686 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:36:29,693 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:36:29,710 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 14:36:29,986 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:36:29,998 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T14:36:29.755000'::timestamp AND timestamp <= '2025-05-25T14:36:29.755000'::timestamp;
2025-05-25 14:36:30,013 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 14:36:30,101 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 14:36:30,306 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:36:30,312 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:36:30,318 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 14:36:30,324 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 14:36:30,354 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 14:36:30,597 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:36:30,608 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T14:36:30.381000'::timestamp AND timestamp <= '2025-05-25T14:36:30.381000'::timestamp;
2025-05-25 14:36:30,622 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 14:36:30,658 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 14:36:30,664 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 14:36:30,670 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 14:36:30,675 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 14:36:30,681 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 14:36:47,844 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:36:47,856 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1112: 
            UPDATE catasto.partita
            SET numero_partita = 4013, tipo = 'principale', data_impianto = '1988-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1112;
        
2025-05-25 14:36:47,870 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1112 aggiornata con successo. Righe modificate: 1
2025-05-25 14:36:47,881 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:36:47,896 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:36:47,908 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1112: 
            UPDATE catasto.partita
            SET numero_partita = 4013, tipo = 'principale', data_impianto = '1988-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1112;
        
2025-05-25 14:36:47,928 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1112 aggiornata con successo. Righe modificate: 1
2025-05-25 14:36:47,941 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:37:13,233 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:37:13,246 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 9008, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 14:37:13,261 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-25 14:37:13,272 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:37:13,289 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:37:13,302 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 9008, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 14:37:13,317 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-25 14:37:13,329 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:03,555 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:03,567 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 1009, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 14:39:03,581 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-25 14:39:03,592 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:03,608 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:03,619 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 1009, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 14:39:03,633 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-25 14:39:03,646 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:56,774 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:56,785 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 8008, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 14:39:56,798 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-25 14:39:56,809 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:56,824 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 14:39:56,836 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1107: 
            UPDATE catasto.partita
            SET numero_partita = 8008, tipo = 'principale', data_impianto = '1978-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1107;
        
2025-05-25 14:39:56,849 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1107 aggiornata con successo. Righe modificate: 1
2025-05-25 14:39:56,860 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:17,283 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:17,299 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 15:03:17,314 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 01c3a66f...
2025-05-25 15:03:18,662 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 15:03:18,670 - CatastoDB - INFO - Disconnessione completata
2025-05-25 15:03:18,676 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 15:03:18,681 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 15:03:18,701 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 15:03:25,837 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 15:03:25,953 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 15:03:26,057 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 15:03:31,277 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 15:03:31,531 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 15:03:31,541 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione 5ba5c630...
2025-05-25 15:03:31,546 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:31,559 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=5ba5c630...
2025-05-25 15:03:32,546 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 15:03:32,893 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:03:32,899 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:03:32,906 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:03:32,912 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:03:32,931 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:03:33,051 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:33,062 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:03:32.953000'::timestamp AND timestamp <= '2025-05-25T15:03:32.953000'::timestamp;
2025-05-25 15:03:33,076 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:03:33,304 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 15:03:33,510 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:03:33,529 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:03:33,537 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:03:33,544 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:03:33,564 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:03:33,800 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:33,811 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:03:33.593000'::timestamp AND timestamp <= '2025-05-25T15:03:33.593000'::timestamp;
2025-05-25 15:03:33,825 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:03:33,862 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 15:03:33,868 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 15:03:33,875 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 15:03:33,881 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 15:03:33,887 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 15:03:45,287 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:45,299 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1114: 
            UPDATE catasto.partita
            SET numero_partita = 6015, tipo = 'principale', data_impianto = '1982-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1114;
        
2025-05-25 15:03:45,315 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1114 aggiornata con successo. Righe modificate: 1
2025-05-25 15:03:45,327 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:45,342 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:03:45,354 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1114: 
            UPDATE catasto.partita
            SET numero_partita = 6015, tipo = 'principale', data_impianto = '1982-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1114;
        
2025-05-25 15:03:45,369 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1114 aggiornata con successo. Righe modificate: 1
2025-05-25 15:03:45,381 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:04:36,116 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:04:36,128 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1100: 
            UPDATE catasto.partita
            SET numero_partita = 9001, tipo = 'principale', data_impianto = '2003-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1100;
        
2025-05-25 15:04:36,143 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1100 aggiornata con successo. Righe modificate: 1
2025-05-25 15:04:36,156 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:04:36,172 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:04:36,185 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1100: 
            UPDATE catasto.partita
            SET numero_partita = 9001, tipo = 'principale', data_impianto = '2003-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1100;
        
2025-05-25 15:04:36,199 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1100 aggiornata con successo. Righe modificate: 1
2025-05-25 15:04:36,210 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:05:52,349 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:05:52,361 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1100: 
            UPDATE catasto.partita
            SET numero_partita = 9001, tipo = 'principale', data_impianto = '2003-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1100;
        
2025-05-25 15:05:52,375 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1100 aggiornata con successo. Righe modificate: 1
2025-05-25 15:05:52,387 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:05:52,402 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:05:52,415 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1100: 
            UPDATE catasto.partita
            SET numero_partita = 9001, tipo = 'principale', data_impianto = '2003-05-24'::date, data_chiusura = '2000-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1100;
        
2025-05-25 15:05:52,428 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1100 aggiornata con successo. Righe modificate: 1
2025-05-25 15:05:52,441 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:08:46,855 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:08:46,868 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 15:08:46,882 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione 5ba5c630...
2025-05-25 15:08:47,979 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 15:08:47,986 - CatastoDB - INFO - Disconnessione completata
2025-05-25 15:08:47,992 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 15:08:47,999 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 15:08:48,012 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 15:09:16,013 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 15:09:16,131 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 15:09:16,237 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 15:09:22,153 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 15:09:22,415 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 15:09:22,424 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a7016508...
2025-05-25 15:09:22,430 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:09:22,442 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=a7016508...
2025-05-25 15:09:23,849 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 15:09:24,368 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:09:24,374 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:09:24,381 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:09:24,389 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:09:24,407 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:09:24,585 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:09:24,597 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:09:24.424000'::timestamp AND timestamp <= '2025-05-25T15:09:24.424000'::timestamp;
2025-05-25 15:09:24,611 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:09:24,850 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 15:09:25,055 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:09:25,061 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:09:25,068 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:09:25,076 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:09:25,095 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:09:25,219 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:09:25,231 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:09:25.114000'::timestamp AND timestamp <= '2025-05-25T15:09:25.114000'::timestamp;
2025-05-25 15:09:25,245 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:09:25,279 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 15:09:25,286 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 15:09:25,291 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 15:09:25,297 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 15:09:25,303 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 15:10:08,919 - CatastoGUI - INFO - Tentativo di aggiornare la partita ID 1100 con i dati: {'numero_partita': 5701, 'tipo': 'principale', 'stato': 'attiva', 'data_impianto': datetime.date(2003, 5, 24), 'data_chiusura': datetime.date(2025, 1, 1), 'numero_provenienza': None}
2025-05-25 15:10:09,071 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:10:09,082 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1100: 
            UPDATE catasto.partita
            SET numero_partita = 5701, tipo = 'principale', data_impianto = '2003-05-24'::date, data_chiusura = '2025-01-01'::date, numero_provenienza = NULL, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1100;
        
2025-05-25 15:10:09,123 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1100 aggiornata con successo. Righe modificate: 1
2025-05-25 15:10:09,134 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:10:09,147 - CatastoGUI - INFO - Partita ID 1100 aggiornata con successo nel database.
2025-05-25 15:10:54,495 - CatastoGUI - INFO - Tentativo di aggiornare la partita ID 1644 con i dati: {'numero_partita': 6545, 'tipo': 'principale', 'stato': 'attiva', 'data_impianto': datetime.date(2024, 4, 16), 'data_chiusura': datetime.date(2025, 1, 1), 'numero_provenienza': 1383}
2025-05-25 15:10:54,502 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:10:54,514 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1644: 
            UPDATE catasto.partita
            SET numero_partita = 6545, tipo = 'principale', data_impianto = '2024-04-16'::date, data_chiusura = '2025-01-01'::date, numero_provenienza = 1383, stato = 'attiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1644;
        
2025-05-25 15:10:54,529 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1644 aggiornata con successo. Righe modificate: 1
2025-05-25 15:10:54,541 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:10:54,554 - CatastoGUI - INFO - Partita ID 1644 aggiornata con successo nel database.
2025-05-25 15:19:24,827 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:19:24,840 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit resettate.
2025-05-25 15:19:24,855 - CatastoDB - INFO - Logout registrato per utente ID 1, sessione a7016508...
2025-05-25 15:19:25,997 - CatastoGUI - INFO - Evento closeEvent intercettato.
2025-05-25 15:19:26,003 - CatastoDB - INFO - Disconnessione completata
2025-05-25 15:19:26,009 - CatastoGUI - INFO - Connessione al database chiusa.
2025-05-25 15:19:26,015 - CatastoGUI - INFO - Applicazione GUI Catasto Storico terminata.
2025-05-25 15:19:26,036 - CatastoGUI - INFO - >>> run_gui_app: app.exec_() TERMINATO con codice: 0
2025-05-25 15:24:05,170 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 15:24:05,329 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 15:24:05,439 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 15:24:11,583 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 15:24:11,840 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 15:24:11,855 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione a40344dc...
2025-05-25 15:24:11,861 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:24:11,876 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=a40344dc...
2025-05-25 15:24:12,672 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 15:24:12,993 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:24:12,999 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:24:13,007 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:24:13,012 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:24:13,032 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:24:13,218 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:24:13,238 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:24:13.086000'::timestamp AND timestamp <= '2025-05-25T15:24:13.086000'::timestamp;
2025-05-25 15:24:13,254 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:24:13,823 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 15:24:14,050 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:24:14,055 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:24:14,062 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:24:14,068 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:24:14,088 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:24:14,216 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:24:14,228 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:24:14.108000'::timestamp AND timestamp <= '2025-05-25T15:24:14.108000'::timestamp;
2025-05-25 15:24:14,241 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:24:14,274 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 15:24:14,279 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 15:24:14,284 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 15:24:14,289 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 15:24:14,294 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 15:25:46,196 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 15:25:46,408 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 15:25:46,513 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 15:25:52,151 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 15:25:52,407 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 15:25:52,421 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione c9d49c4b...
2025-05-25 15:25:52,427 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:25:52,440 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=c9d49c4b...
2025-05-25 15:25:53,892 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 15:25:54,362 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:25:54,388 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:25:54,414 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:25:54,420 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:25:54,448 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:25:54,678 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:25:54,689 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:25:54.471000'::timestamp AND timestamp <= '2025-05-25T15:25:54.471000'::timestamp;
2025-05-25 15:25:54,703 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:25:54,919 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 15:25:55,150 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:25:55,157 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:25:55,164 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:25:55,172 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:25:55,192 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:25:55,332 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:25:55,344 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:25:55.219000'::timestamp AND timestamp <= '2025-05-25T15:25:55.219000'::timestamp;
2025-05-25 15:25:55,358 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:25:55,394 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 15:25:55,399 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 15:25:55,405 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 15:25:55,411 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 15:25:55,417 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 15:28:57,766 - CatastoDB_catasto_storico_localhost - INFO - Inizializzato gestore per database catasto_storico (schema: catasto) con log_level: DEBUG
2025-05-25 15:28:57,885 - CatastoDB_catasto_storico_localhost - INFO - Pool di connessioni PostgreSQL per 'CatastoApp' inizializzato con successo.
2025-05-25 15:28:57,996 - CatastoDB - INFO - Connessione stabilita con successo
2025-05-25 15:29:03,616 - CatastoDB - INFO - Credenziali (incluso ruolo) recuperate per utente: admin, Ruolo: admin
2025-05-25 15:29:03,871 - CatastoGUI - INFO - Login GUI OK per ID: 1
2025-05-25 15:29:03,884 - CatastoDB - INFO - Registrato accesso: Utente ID 1, Azione login, Esito True, Sessione e58f3ef5...
2025-05-25 15:29:03,890 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:03,904 - CatastoDB_catasto_storico_localhost - INFO - Variabili di sessione per audit impostate: app_user_id=1, session_id=e58f3ef5...
2025-05-25 15:29:04,652 - CatastoGUI - INFO - >>> CatastoMainWindow: Inizio perform_initial_setup
2025-05-25 15:29:05,322 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:29:05,328 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:29:05,336 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:29:05,342 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:29:05,361 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:29:05,482 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:05,493 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:29:05.386000'::timestamp AND timestamp <= '2025-05-25T15:29:05.386000'::timestamp;
2025-05-25 15:29:05,508 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:29:05,598 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a setup_tabs
2025-05-25 15:29:06,090 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_statistiche_comune ORDER BY comune... Errore: ERRORE:  la vista materializzata "mv_statistiche_comune" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:29:06,097 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:29:06,103 - CatastoDB - ERROR - Errore DB durante l'esecuzione della query: SELECT * FROM mv_immobili_per_tipologia ORDER BY comune_nome, classificazione LIMIT %s... Errore: ERRORE:  la vista materializzata "mv_immobili_per_tipologia" non Ë stata popolata
HINT:  Usa il comando REFRESH MATERIALIZED VIEW.

2025-05-25 15:29:06,109 - CatastoDB - INFO - Rollback eseguito.
2025-05-25 15:29:06,128 - CatastoDB - INFO - Recuperati 1 utenti.
2025-05-25 15:29:06,254 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:06,266 - CatastoDB_catasto_storico_localhost - DEBUG - Audit Log Count Query: SELECT COUNT(*) FROM catasto.audit_log WHERE timestamp >= '2025-05-24T15:29:06.150000'::timestamp AND timestamp <= '2025-05-25T15:29:06.150000'::timestamp;
2025-05-25 15:29:06,280 - CatastoDB_catasto_storico_localhost - INFO - Nessun record di audit log trovato con i filtri specificati.
2025-05-25 15:29:06,314 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a update_ui_based_on_role
2025-05-25 15:29:06,320 - CatastoGUI - INFO - >>> CatastoMainWindow: Chiamata a self.show()
2025-05-25 15:29:06,325 - CatastoGUI - INFO - >>> CatastoMainWindow: self.show() completato. Fine perform_initial_setup
2025-05-25 15:29:06,331 - CatastoGUI - INFO - >>> run_gui_app: Login successo, preparazione per app.exec_()
2025-05-25 15:29:06,336 - CatastoGUI - INFO - >>> run_gui_app: STA PER ESSERE CHIAMATO app.exec_()
2025-05-25 15:29:20,693 - CatastoGUI - INFO - Tentativo di aggiornare i dati generali della partita ID 1115 con: {'numero_partita': 1016, 'tipo': 'principale', 'stato': 'inattiva', 'data_impianto': datetime.date(1982, 5, 24), 'data_chiusura': datetime.date(2025, 3, 20), 'numero_provenienza': None}
2025-05-25 15:29:20,795 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:20,806 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1115: 
            UPDATE catasto.partita
            SET numero_partita = 1016, tipo = 'principale', data_impianto = '1982-05-24'::date, data_chiusura = '2025-03-20'::date, numero_provenienza = NULL, stato = 'inattiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1115;
        
2025-05-25 15:29:20,822 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1115 aggiornata con successo. Righe modificate: 1
2025-05-25 15:29:20,833 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:20,845 - CatastoGUI - INFO - Dati generali della Partita ID 1115 aggiornati con successo.
2025-05-25 15:29:23,430 - CatastoGUI - INFO - Tentativo di aggiornare la partita ID 1115 con i dati: {'numero_partita': 1016, 'tipo': 'principale', 'stato': 'inattiva', 'data_impianto': datetime.date(1982, 5, 24), 'data_chiusura': datetime.date(2025, 3, 20), 'numero_provenienza': None}
2025-05-25 15:29:23,436 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione ottenuta dal pool. Dettagli: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:23,448 - CatastoDB_catasto_storico_localhost - DEBUG - Esecuzione query UPDATE partita ID 1115: 
            UPDATE catasto.partita
            SET numero_partita = 1016, tipo = 'principale', data_impianto = '1982-05-24'::date, data_chiusura = '2025-03-20'::date, numero_provenienza = NULL, stato = 'inattiva', data_modifica = CURRENT_TIMESTAMP
            WHERE id = 1115;
        
2025-05-25 15:29:23,463 - CatastoDB_catasto_storico_localhost - INFO - Partita ID 1115 aggiornata con successo. Righe modificate: 1
2025-05-25 15:29:23,475 - CatastoDB_catasto_storico_localhost - DEBUG - Connessione rilasciata al pool. Dettagli DSN: user=postgres password=xxx dbname=catasto_storico host=localhost port=5432 options='-c search_path=catasto,public -c application_name=CatastoApp'
2025-05-25 15:29:23,487 - CatastoGUI - INFO - Partita ID 1115 aggiornata con successo nel database.
